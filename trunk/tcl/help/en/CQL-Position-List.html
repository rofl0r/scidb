<?xml version="1.0" encoding="utf-8"?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated from tcl/help/en/CQL-Position-List.txt -->

<html xmlns='http://www.w3.org/1999/xhtml' xml:lang='en' lang='en'>
<head>
  <meta http-equiv="content-type"
           content="text/html; charset=utf-8" />
  <meta http-equiv="content-language"
           content="en" />
  <meta http-equiv="content-style-type"
           content="text/css" />

  <meta name="author"
     content="scidb.sourceforge.net" />
  <meta name="generator"
     content="scidb.sourceforge.net" />
  <meta name="description"
     content="Scidb - Help Page" />

  <link rel="icon"
       href="http://scidb.sourceforge.net/favicon.ico"
       type="image/x-icon" />
  <link rel="shortcut icon"
       href="http://scidb.sourceforge.net/favicon.ico" />
  <link rel="stylesheet"
       type="text/css"
      media="screen"
		 href="../styles/help.css" />

  <title>Scidb - Help: CQL - The position list</title>

  <style type="text/css">
  
    #tooltip1 {
      outline: none;
      cursor: help;
      margin-top: 0;
      margin-bottom: 0;
      position: relative;
    }
    #tooltip1 a {
      color: #000000;
    }
    #tooltip1 a:hover {
      color: #000000;
      background: #ffff00;
      text-decoration: none;
    }
    #tooltip1 a img {
      display: none;
    }
    #tooltip1 a:hover img {
      display: block;
      position: absolute;
      left: 10em;
      top: 2em;
      z-index: 99;
    }
    </style>
</head>

<body>

<div class="title">
  <h1 class="title">CQL - The position list</h1>
</div>

<p>
The symbol <img src="../images/ft-scidb-tiny.png" alt="" /> in the title of a
keyword description denotes that this keyword is an extension, it is not
part of the CQL standard.
</p>

<p>
The keywords <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:castling">:castling</span></a>, <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:endgame">:endgame</span></a>, and
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:inside">:inside</span></a> are borrowed from Chess Assistant 9. The description
of these keywords are taken from
<a href="http://hornid.com/chess/docs/CQL-3GX.pdf" target="blank_">The CQL 3.GX Extension&nbsp;<span class="awesome">&#xf08e;</span></a>.
</p>

<p>
Some of the keywords can be negated with a preceding exclamation, then this is
an abbreviation; e.g.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'>!<a href="CQL-Position-List.html#position:check">:check</span></a>)
</code></div>

<p>
is an abbreviation for
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:not">:not</span></a> (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:check">:check</span></a>))
</code></div>

<p>
The keywords <span style='white-space:nowrap;'>:nocheck</span>, and <span style='white-space:nowrap;'>:noenpassant</span> are not
used anymore in <span style='white-space:nowrap;'>CQL-S</span> &ndash; the expressions
<span style='white-space:nowrap;'>!:check</span>, and <span style='white-space:nowrap;'>!:enpassant</span> should be used instead
&ndash; but will be recognized and transformed accordingly when importing
CQL scripts.
</p>

<ul style='list-style-type: none'><li>
  <table style="white-space:nowrap">
    <tr><td>&#x2022;</td><td><a href="#index">Index</a></td></tr>
    <tr><td>&#x2022;</td><td><a href="#logical">Logical keywords</a></td></tr>
    <tr><td>&#x2022;</td><td><a href="#simple">Simple keywords</a></td></tr>
    <tr><td>&#x2022;</td><td><a href="#transform">Transformation keywords</a></td></tr>
    <tr><td>&#x2022;</td><td><a href="#piece">Piece configuration keywords</a></td></tr>
    <tr><td>&#x2022;</td><td><a href="#move">Move keywords</a></td></tr>
    <tr><td>&#x2022;</td><td><a href="#sequence">Sequence keywords</a></td></tr>
    <tr><td>&#x2022;</td><td><a href="#game">Game related keywords</a></td></tr>
    <tr><td>&#x2022;</td><td><a href="#relation">Relation between positions</a></td></tr>
    <tr><td>&#x2022;</td><td><a href="#matching">Matching count keywords</a></td></tr>
    <tr><td>&#x2022;</td><td><a href="#evaluation">Analyzing keywords</a></td></tr>
    <tr><td>&#x2022;</td><td><a href="#accumulator">Accumulator keywords</a></td></tr>
    <tr><td>&#x2022;</td><td><a href="#tagging">Tagging keywords</a></td></tr>
    <tr><td>&#x2022;</td><td><a href="#control">Controlling keywords</a></td></tr>
    <tr><td>&#x2022;</td><td><a href="#meaningless">Meaningless keywords</a></td></tr>
  </table>
</li></ul>

<!-- ############################################################################## -->
<h2 id="index">Index</h2>
<!-- ############################################################################## -->

<table style="white-space:nowrap">
  <tr>
    <td>      &#x2022;</td><td><a href="#position:accumulate">:accumulate</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:flipdihedral">:flipdihedral</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:matchconsecutive">:match</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:rayhorizontal">:rayhorizontal</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:accumulate_">:accumulate*</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:fliphorizontal">:fliphorizontal</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:matchcount">:matchcount</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:rayorthogonal">:rayorthogonal</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:and">:and</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:flipvertical">:flipvertical</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:mate">:mate</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:rayvertical">:rayvertical</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:attackcount">:attackcount</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:forced">:forced</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:matingmaterial">:matingmaterial</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:relation">:relation</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:blackcannotwin">:blackcannotwin</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:gameisover">:gameisover</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:maxswapevaluation">:maxswapevaluation</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:repetitioncount">:repetitioncount</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:blackelo">:blackelo</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:gappedsequence">:gappedsequence</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:moveevaluation">:moveevaluation</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:result">:result</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:btm">:btm</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:goodbishop">:goodbishop</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:movefrom">:movefrom</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:sequence">:sequence</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:catureforced">:captureforced</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:halfmoveclock">:halfmoveclock</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:movenumber">:movenumber</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:shift">:shift</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:castling">:castling</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:halfmovenumber">:halfmovenumber</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:moveto">:moveto</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:shiftdiagonal">:shiftdiagonal</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:check">:check</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:initial">:initial</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:mustcapture">:mustcapture</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:shifthorizontal">:shifthorizontal</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:checkcount">:checkcount</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:inside">:inside</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:noannotate">:noannotate</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:shiftmaindiagonal">:shiftmaindiagonal</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:collateral">:collateral</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:insidevariation">:insidevariation</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:nocheck">:nocheck</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:shiftoffdiagonal">:shiftoffdiagonal</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:cond">:cond</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:iscastling">:iscastling</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:noenpassant">:noenpassant</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:shiftvertical">:shiftvertical</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:contactcheck">:contactcheck</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:ischeck">:ischeck</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:not">:not</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:skip">:skip</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:cut">:cut</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:ischess960">:ischess960</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:opposition">:opposition</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:stalemate">:stalemate</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:doublecheck">:doublecheck</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:iscontactcheck">:iscontactcheck</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:or">:or</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:startposition">:startposition</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:elo">:elo</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:isdoublecheck">:isdoublecheck</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:pawncount">:pawncount</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:sumrange">:sumrange</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:endgame">:endgame</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:isillegal">:isillegal</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:piececount">:piececount</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:tagmatch">:tagmatch</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:endgameevaluation">:endgameevaluation</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:isinvalid">:isinvalid</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:pawncountdifference">:pawncountdifference</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:takeslastpiece">:takeslastpiece</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:endgameevaluation_">:endgameevaluation*</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:ismate">:ismate</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:piececountdifference">:piececountdifference</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:terminal">:terminal</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:enpassant">:enpassant</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:isnull">:isnull</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:perpendicular">:perpendicular</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:threefoldrepetition">:threefoldrepetition</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:evaluation">:evaluation</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:isshufflechess">:isshufflechess</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:power">:power</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:threechecks">:threechecks</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:exchangeevaluation">:exchangeevaluation</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:isstalemate">:isstalemate</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:powerdifference">:powerdifference</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:variant">:variant</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:exclude">:exclude</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:kingonthehill">:kingonthehill</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:pretransformmatchcount">:pretransformmatchcount</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:variations">:variations</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:fen">:fen</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:line">:line</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:pretransformrepetitioncount">:pretransformrepetitioncount</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:variationsonly">:variationsonly</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:fivefoldrepetition">:fivefoldrepetition</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:line_">:line*</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:promote">:promote</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:whitecannotwin">:whitecannotwin</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:flip">:flip</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:losing">:losing</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:ray">:ray</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:whiteelo">:whiteelo</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:flipcolor">:flipcolor</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:markall">:markall</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:rayattack">:rayattack</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:wtm">:wtm</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:flipdiagonal">:flipdiagonal</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:match">:match</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:raydiagonal">:raydiagonal</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:xor">:xor</a></td>
  </tr>
</table>

<!-- ############################################################################## -->
<h2 id="logical">Logical keywords</h2>
<!-- ############################################################################## -->

<table style="white-space:nowrap">
  <tr><td>&#x2022;</td><td><a href="#position:and">:and</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:cond">:cond</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:not">:not</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:or">:or</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:xor">:xor</a></td></tr>
</table>

<h3 id="position:and">:and</h3>

<p>
Takes a list of position lists and matches a position only if each of them
match the position.
</p>

<p>
Example:
</p>

<div class='box'><pre><code><!--
-->(position
  <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:wtm">:wtm</span></a>
  <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:check">:check</span></a>
  <span style='white-space:nowrap;'><span class='keyword'>:and</span></span> (
    (position <span class='piece'>&#x2654;</span>e2 <span class='piece'>&#x265a;</span>g2 <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:shift">:shift</span></a> <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:flip">:flip</span></a>)
    (position <span class='piece'>&#x2658;</span>e2)))<!--
--></code></pre></div>

<p>
Will match positions in which the kings are in direct opposition, there is a white
knight on e2, and white is in check.
</p>

<h3 id="position:cond">:cond&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
This keyword will be used in the following general form:
</p>

<div class='box'><pre><code><!--
--><span style='white-space:nowrap;'><span class='keyword'>:cond</span></span>
  (position &lt;Condition<sub>1</sub>&gt;) (position &lt;Expression<sub>1</sub>&gt;)
  (position &lt;Condition<sub>2</sub>&gt;) (position &lt;Expression<sub>2</sub>&gt;)
  ...
  (position &lt;Condition<sub>k</sub>&gt;) (position &lt;Expression<sub>k</sub>&gt;)<!--
--></code></pre></div>

<p>
<span style='white-space:nowrap;'>:cond</span> expects an arbitrary number of arguments. Each argument
<span style='white-space:nowrap;'><code>&lt;Condition<sub>i</sub>&gt;</code></span> will be called a clause, and each
argument <span style='white-space:nowrap;'><code>&lt;Expression<sub>i</sub>&gt;</code></span> is an association.
Successively each clause will be evaluated until a matching clause is found,
the associated expression is the result of the whole <span style='white-space:nowrap;'>:cond</span> expression.
A game cannot match if no clause is matching. This means that the order of the
lists inside an <span style='white-space:nowrap;'>:cond</span> is important. A position cannot match if none of
the clauses is matching. It is not allowed that an argument contains a position list.
</p>

<p>
Often the final pair will be expressed in the following form:
</p>

<div class='box'><pre><code><!--
-->(position) (position &lt;Expression&gt;)<!--
--></code></pre></div>

<p>
The empty list is matching any position. This case can be expressed in an
abbreviated form, by omiting the second last argument <span style='white-space:nowrap;'><code>(position)</code></span>.
Then the result of the last expression will be evaluated if no clause is
succeeding.
</p>

<p>
In fact the keyword <span style='white-space:nowrap;'>:cond</span> is not redundant, because the conversion
with the use of keyword <span style='white-space:nowrap;'>:or</span> is not equivalent in all cases (the
use of <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:cut">:cut</span></a>, <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:exclude">:exclude</span></a>, or
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:skip">:skip</span></a> is breaking the equivalence). Moreover the order
inside of <span style='white-space:nowrap;'>:cond</span> is significant.
</p>

<div class='box'><pre><code><!--
-->(position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:or">:or</span></a> (
  (position &lt;Condition<sub>1</sub>&gt; &lt;Expression<sub>1</sub>&gt;)
  (position &lt;Condition<sub>2</sub>&gt; &lt;Expression<sub>2</sub>&gt;)
  ...
  (position &lt;Condition<sub>k</sub>&gt; &lt;Expression<sub>k</sub>&gt;)))<!--
--></code></pre></div>

<p>
Furthermore the <span style='white-space:nowrap;'>:cond</span> expression will be executed quite more
efficient (consider the case that <span style='white-space:nowrap;'><code>&lt;Condition<sub>1</sub>&gt;</code></span>
will match, but not <span style='white-space:nowrap;'><code>&lt;Expression<sub>1</sub>&gt;</code></span>, then the
<span style='white-space:nowrap;'>:or</span> form will proceed with next list, while the <span style='white-space:nowrap;'>:cond</span>
form is delivering the result of <span style='white-space:nowrap;'><code>&lt;Expression<sub>1</sub>&gt;</code></span>
immediately).
</p>

<p>
However the <span style='white-space:nowrap;'>:or</span> form shows why the <span style='white-space:nowrap;'>:cond</span> form
is also using the association for marking the matches (this is another
difference to the <span style='white-space:nowrap;'>:or</span> form). To give an example:
</p>

<div class='box'><pre><code><!--
-->(match
  (position <span style='white-space:nowrap;'><span class='keyword'>:cond</span></span> (
    (position <span class='piece'>&#x2659;</span>e7) (position <span class='piece'>&#x265f;</span>e2))))<!--
--></code></pre></div>

<p>
If a position has a white pawn on square e7, and a black pawn on square e2,
both squares will be marked in any matching position.
</p>

<p>
See <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:exclude">:exclude</span></a> for a real example showing the usage
of <span style='white-space:nowrap;'>:cond</span>.
</p>

<h3 id="position:not">:not</h3>

<p>
This keyword can be used in two forms: either it is included in a position
match list, or it has a sub-position list as argument. In former case:
match if the containing match list would not match without the
<span style='white-space:nowrap;'>:not</span>. In latter case negate the result of the sub-position list
match. The former case is conform with CQL standard of keyword <span style='white-space:nowrap;'>:not</span>,
the second form is an extension.
</p>

<p>
Examples:
</p>

<div class='box'><pre><code><!--
-->(match
  (position
    ; <span class='comment'>we are searching for either colors</span>
    <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:flipcolor">:flipcolor</span></a>
    <span class='comment'>; the mating position must match each criterion below</span>
    <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:and">:and</span></a> (
      <span class='comment'>; the black king is surrounded by empty squares and</span>
      <span class='comment'>; is attacked once and is in mate</span>
      (position
        <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:attackcount">:attackcount</span></a> <span class='piece'>&#x265a;</span> . 8
        <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:attackcount">:attackcount</span></a> <span class='cql' title='Any white piece'>&#x25cb;</span> <span class='piece'>&#x265a;</span> 1
        <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:mate">:mate</span></a>
        <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:btm">:btm</span></a>)
      <span class='comment'>; check that no neighbor of the black king is</span>
      <span class='comment'>; attacked more than once</span>
      (position
        <span style='white-space:nowrap;'><span class='keyword'>:not</span></span>
        <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:attackcount">:attackcount</span></a> <span class='piece'>&#x265a;</span> .e4 1
        <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:attackcount">:attackcount</span></a> <span class='cql' title='Any white piece'>&#x25cb;</span> .e4 &gt;=2
        <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:shift">:shift</span></a>))))<!--
--></code></pre></div>

<p>
This finds all ideal mirror mates: studies in which the king is surrounded by
empty squares, is attacked once, such that if the king were to move to one of
its neighbors, it would be attacked exactly once.
</p>

<p>
The follwing position match
</p>

<div class='verb'><code>
(position <span class='piece'>&#x2656;</span>a3 <span style='white-space:nowrap;'><span class='keyword'>:not</span></span>)
</code></div>

<p>
is equivalent to
</p>

<div class='verb'><code>
(position [<span class='cql' title='Any black piece'>&#x25cf;</span><span class='piece'>&#x2655;</span><span class='piece'>&#x2657;</span><span class='piece'>&#x2658;</span><span class='piece'>&#x2659;</span><span class='piece'>&#x2654;</span>.]a3)
</code></div>

<p>
In this case the simpler form with <span style='white-space:nowrap;'>:not</span> is preferable.
</p>

<h3 id="position:or">:or</h3>

<p>
Takes a list of position lists and matches a position only if at least one of
them matches the position.
</p>

<p>
Example:
</p>

<div class='box'><pre><code><!--
-->(match
  (position
    <span style='white-space:nowrap;'><span class='keyword'>:or</span></span> (
      (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> <span class='piece'>&#x2657;</span><span class='cql' title='Light squares'>&#x25a1;</span>? 2)
      (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> <span class='piece'>&#x265d;</span><span class='cql' title='Light squares'>&#x25a1;</span>? 2)
      (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> <span class='piece'>&#x2657;</span><span class='cql' title='Dark squares'>&#x25a0;</span>? 2)
      (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> <span class='piece'>&#x265d;</span><span class='cql' title='Dark squares'>&#x25a0;</span>? 2))))<!--
--></code></pre></div>

<p>
Searching for games with one side has two bishops of same color.
</p>

<h3 id="position:xor">:xor</h3>

<p>
Expects a list of position lists and is matching a position if and
only if exactly one of the position lists is matching this position.
</p>

<p>
Example:
</p>

<div class='box'><pre><code><!--
-->(position <span style='white-space:nowrap;'><span class='keyword'>:xor</span></span> ((position <span class='piece'>&#x2657;</span><span class='cql' title='Dark squares'>&#x25a0;</span>?) (position <span class='piece'>&#x2657;</span><span class='cql' title='Light squares'>&#x25a1;</span>?)))<!--
--></code></pre></div>

<p>
Match all position where either White has a light-squared bishop or a
dark-squared bishop, but not both.
</p>

<h3 id="position:xor">:xor&emsp;<span class='normal'>(Exklusives Oder)</span></h3>

<p>
Erwartet eine Liste von Positionslisten und filtert nur dann eine
Position, wenn genau eine von ihnen diese Position filtert.
</p>

<p>
Beispiel:
</p>

<div class='box'><pre><code><!--
-->(position <span style='white-space:nowrap;'><span class='keyword'>:xor</span></span> ((position <span class='piece'>&#x2657;</span><span class='cql' title='Dark squares'>&#x25a0;</span>?) (position <span class='piece'>&#x2657;</span><span class='cql' title='Light squares'>&#x25a1;</span>?)))<!--
--></code></pre></div>

<p>
Findet Positionen auf, in denen WeiÃ entweder einen weiÃfeldrigen LÃ¤ufer, oder
einen schwarzfeldrigen LÃ¤ufer hat, aber nicht beides.
</p>

<!-- ############################################################################## -->
<h2 id="simple">Simple keywords</h2>
<!-- ############################################################################## -->

<table style="white-space:nowrap">
  <tr>
    <td>      &#x2022;</td><td><a href="#position:blackcannotwin">:blackcannotwin</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:kingonthehill">:kingonthehill</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:btm">:btm</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:losing">:losing</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:castling">:castling</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:mate">:mate</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:check">:check</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:matingmaterial">:matingmaterial</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:contactcheck">:contactcheck</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:mustcapture">:mustcapture</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:catureforced">:catureforced</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:nocheck">:nocheck</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:doublecheck">:doublecheck</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:stalemate">:stalemate</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:endgame">:endgame</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:terminal">:terminal</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:fen">:fen</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:threechecks">:threechecks</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:fivefoldrepetition">:fen</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:threefoldrepetition">:threechecks</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:gameisover">:gameisover</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:variations">:variations</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:halfmoveclock">:halfmoveclock</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:variationsonly">:variationsonly</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:initial">:initial</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:whitecannotwin">:whitecannotwin</a></td>
  </tr>
    <td>      &#x2022;</td><td><a href="#position:insidevariation">:insidevariation</a></td>
    <td>&emsp;&#x2022;</td><td><a href="#position:wtm">:wtm</a></td>
  </tr>
  <tr>
    <td>      &#x2022;</td><td><a href="#position:ispromotedpiece">:ispromotedpiece</a></td>
  </tr>
</table>

<h3 id="position:blackcannotwin">:blackcannotwin&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
Match only if black cannot win in this position.
</p>

<p>
Normally this is equivalent to following query:
</p>

<div class='box'><pre><code><!--
--><span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:or">:or</span></a> (
  <span class='comment'>; black king only</span>
  (<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> <span class='cql' title='Any black piece'>&#x25cf;</span> 1)
  <span class='comment'>; black king and black minor piece only</span>
  (<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> <span class='cql' title='Any black piece'>&#x25cf;</span> 2 <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> <span class='cql' title='Black minor piece'>&#x25bc;</span> 1))<!--
--></code></pre></div>

<p>
In chess variant Three-check Chess the query with
<span style='white-space:nowrap;'>:blackcannotwin</span> succeeds only if black has no more pieces than
the king, and in all other chess variants this query has no meaning and is
always failing.
</p>

<p>
In chess variant King-of-the-Hill <span style='white-space:nowrap;'>:blackcannotwin</span>
cannot match any game.
</p>

<p>
This keyword can be used in a negated form; with a preceding exclamation
mark. Example:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'>!<span class='keyword'>:blackcannotwin</span></span>)
</code></div>

<p>
Match all position where black (theoretically) still has winning chances.
</p>

<p>
See also: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:whitecannotwin">:whitecannotwin</span></a>
</p>

<h3 id="position:btm">:btm</h3>

<p>
Match only if black is to move.
</p>

<p>
See also: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:wtm">:wtm</span></a>.
</p>

<h3 id="position:check">:check</h3>

<p>
One side is in check.  This keyword can be used in a negated form; with
a preceding exclamation mark. Example:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'>!<span class='keyword'>:check</span></span>)
</code></div>

<p>
Neither side is in check.
</p>

<p>
See also:
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:ischeck">:ischeck</span></a>,
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:contactcheck">:contactcheck</span></a>,
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:doublecheck">:doublecheck</span></a>.
</p>

<h3 id="position:castling">:castling&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
This keyword specifies castling availabilities for either sides. It takes as an
argument a piecetype designator, letters of which have the following meanings:
</p>

<ul style='list-style-type: none'><li>
  <table>
    <tr>
      <td class="l"><span style='white-space:nowrap;'><code><span class='piece'>&#x2654;</span></code></span></td>
      <td class="r">White has kingside castling availability</td>
    </tr>
    <tr>
      <td class="l"><span style='white-space:nowrap;'><code><span class='piece'>&#x2655;</span></code></span></td>
      <td class="r">White has queenside castling availability</td>
    </tr>
    <tr>
      <td class="l"><span style='white-space:nowrap;'><code><span class='piece'>&#x265a;</span></code></span></td>
      <td class="r">Black has kingside castling availability</td>
    </tr>
    <tr>
      <td class="l"><span style='white-space:nowrap;'><code><span class='piece'>&#x265b;</span></code></span></td>
      <td class="r">Black has queenside castling availability</td>
    </tr>
  </table>
</li></ul>

<p>
Examples:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:castling</span></span> <span class='piece'>&#x2654;</span>)
</code></div>

<p>
White has kingside castling availability.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:castling</span></span> [<span class='piece'>&#x2654;</span><span class='piece'>&#x2655;</span>])
</code></div>

<p>
White has either kingside or queenside castling availability
(but not both).
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:castling</span></span> <span class='piece'>&#x2654;</span> <span style='white-space:nowrap;'><span class='keyword'>:castling</span></span> <span class='piece'>&#x2655;</span>)
</code></div>

<p>
White has either kingside and queenside castling availabilities.
</p>

<p>
See also: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:iscastling">:iscastling</span></a>.
</p>

<h3 id="position:contactcheck">:contactcheck&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
One side is in check, and it is a contact check (it's not possible to place
a piece between the checker and the king, even not theoretical). This
includes knight checks and double checks.
</p>

<p>
This is equivalent to:
</p>

<div class='box'><pre><code><!--
-->(position
  <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:check">:check</span></a> <span class='comment'>; exclude Antichess games</span>
  <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:or">:or</span></a> (
    (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:doublecheck">:doublecheck</span></a>)
    (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:attackcount">:attackcount</span></a> [<span class='piece'>&#x2658;</span><span class='piece'>&#x2659;</span>] <span class='piece'>&#x265a;</span> 1 <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:flipcolor">:flipcolor</span></a>)
    (position [<span class='piece'>&#x2655;</span><span class='piece'>&#x2656;</span>]d4 <span class='piece'>&#x265a;</span>[c4,e4,d3,d5] <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:flipcolor">:flipcolor</span></a> <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:shift">:shift</span></a>)
    (position [<span class='piece'>&#x2655;</span><span class='piece'>&#x2657;</span>]d4 <span class='piece'>&#x265a;</span>[c3,c5,e3,e5] <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:flipcolor">:flipcolor</span></a> <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:shift">:shift</span></a>)))<!--
--></code></pre></div>

<p>
This keyword can be used in a negated form; with a preceding exclamation
mark. Example:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'>!<span class='keyword'>:contactcheck</span></span>)
</code></div>

<p>
Neither side is in check, or it is not a contact check.
</p>

<p>
It is possible to restrict the pieces with an optional piece designator. Example:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:contactcheck</span></span> <span class='piece'>&#x2655;</span>)
</code></div>

<p>
A white queen is adjacent to the opposing king (contact check).
</p>

<div class='verb'><code>
(position !<span style='white-space:nowrap;'><span class='keyword'>:contactcheck</span></span> <span class='piece'>&#x2655;</span>)
</code></div>

<p>
The white queen is not adjacent to the opposing king.
</p>

<p>
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:iscontactcheck">:iscontactcheck</span></a>,
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:check">:check</span></a>,
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:doublecheck">:doublecheck</span></a>.
</p>

<h3 id="position:doublecheck">:doublecheck&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
One side is in check, and it is a double check.
</p>

<p>
In fact this is an abbreviation for:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:attackcount">:attackcount</span></a> <span class='cql' title='Any white piece'>&#x25cb;</span> <span class='piece'>&#x265a;</span> &gt;=2 <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:flipcolor">:flipcolor</span></a>)
</code></div>

<p>
This keyword can be used in a negated form; with a preceding exclamation
mark. Example:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'>!<span class='keyword'>:doublecheck</span></span>)
</code></div>

<p>
Match all position where neither side is double checked.
</p>

<p>
See also:
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:isdoublecheck">:isdoublecheck</span></a>,
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:check">:check</span></a>,
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:contactcheck">:contactcheck</span></a>.
</p>

<h3 id="position:endgame">:endgame&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
The position is an endgame position. The keyword is equivalent to the following
query:
</p>

<div class='box'><pre><code><!--
-->  (position
    <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:or">:or</span></a> (
      (position
        <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> [<span class='piece'>&#x2655;</span><span class='piece'>&#x265b;</span>] 0
        <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> [<span class='piece'>&#x2656;</span><span class='piece'>&#x2657;</span><span class='piece'>&#x2658;</span>] 0 3
        <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> [<span class='piece'>&#x265c;</span><span class='piece'>&#x265d;</span><span class='piece'>&#x265e;</span>] 0 3)
      (position
        <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> <span class='piece'>&#x2655;</span> 1
        <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> <span class='piece'>&#x265b;</span> 1
        <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> [<span class='piece'>&#x2656;</span><span class='piece'>&#x265c;</span>] 0
        <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> <span class='cql' title='White minor piece'>&#x25bd;</span> 0 1
        <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> <span class='cql' title='Black minor piece'>&#x25bc;</span> 0 1)
      (position
        <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> <span class='piece'>&#x2655;</span> 1
        <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> <span class='piece'>&#x2656;</span> 0
        <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> <span class='cql' title='White minor piece'>&#x25bd;</span> 0 1
        <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> <span class='piece'>&#x265b;</span> 0
        <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:power">:power</span></a> [<span class='piece'>&#x265c;</span><span class='piece'>&#x265d;</span><span class='piece'>&#x265e;</span>] 0 16
        <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:flipcolor">:flipcolor</span></a>)))<!--
--></code></pre></div>

<p>
This keyword can be used in a negated form; with a preceding exclamation
mark. Example:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'>!<a href="CQL-Position-List.html#position:endgame">:endgame</span></a>)
</code></div>

<p>
Match all positions which are not an endgame position.
</p>

<h3 id="position:fen">:fen&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
The position is equal to the described position in given argument.
This argument must be a valid <a href="FEN.html">FEN (Forsyth-Edwards Notation)</a>.
</p>

<p>
Example:
</p>

<div class='box'><pre><code><!--
-->(position
  <span style='white-space:nowrap;'><span class='keyword'>:fen</span></span> "rnbqkbnr/pppp1ppp/4p3/8/4P3/8/PPPP1PPP/RNBQKBNR w KQkq - 0 2")<!--
--></code></pre></div>

<p>
This position denotes a basic position of the French line. Normally this
position will be achieved with the line 1.e4 e6 2.d4 d5.
</p>

<p>
See also: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:line_">:line*</span></a>.
</p>

<h3 id="position:fivefoldrepetition">:fivefoldrepetition&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
Match first position of mainline which occurred the third time in this game,
with same player to move, and each player has the same castling and en-passant
capturing rights. The repeated positions need not occur in succession. This
accords with the new FIDE rules of fivefold repetition.
</p>

<p>
Inside of sub-variants this keyword has no effect and will always fail.
</p>

<p>
This keyword can be used in a negated form; with a preceding exclamation
mark. Example:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'>!<span class='keyword'>:fivefoldrepetition</span></span>)
</code></div>

<p>
Match any position which is not occurring the fifth time. If it is
not wanted to match positions after a fivefold repetition has
occurred, then realize this with <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:cut">:cut</span></a>:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:fivefoldrepetition</span></span> <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:cut">:cut</span></a>)
</code></div>

<h3 id="position:gameisover">:gameisover&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
This is an abbreviation for:
</p>

<div class='box'><pre><code><!--
-->  <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:or">:or</span></a> (
    (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:mate">:mate</span></a>)
    (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:stalemate">:stalemate</span></a>)
    (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:losing">:losing</span></a>)
    (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:checkcount">:checkcount 3</span></a>)
    (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:nomatingmaterial">:nomatingmaterial</span></a>))<!--
--></code></pre></div>

<p>
Note that this keyword may effect unwanted results if the search
includes sub-variations.
</p>

<p>
Examples:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:gameisover</span></span>)
</code></div>

<p>
Matches all games ending in a position which prevents continuing.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'>!<span class='keyword'>:gameisover</span></span>)
</code></div>

<p>
Match all position which can be continued (according to the chess rules).
</p>

<h3 id="position:halfmoveclock">:halfmoveclock&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
This keyword is matching a position when the halfmove clock lies inside
the <a href="CQL-Range-Specifiers.html">range specifier</a>, given by the
first argument. Inside of sub-variations this keyword has no effect and
will always succeed.
</p>

<p>
Halfmove clock: This is the number of halfmoves since the last pawn
advance or capture. This is also used to determine if a draw can be
claimed under the fifty-move rule.
</p>

<p>
Example:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:halfmoveclock</span></span> &lt;=30)
</code></div>

<p>
Exclude all positions where no capture has been made and no pawn has been
moved since more than thirty halfmoves (15 moves by each side).
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:halfmoveclock</span></span> &gt;=100 !<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:terminal">:terminal</span></a>)
</code></div>

<p>
First position in game where no capture has been made and no pawn has been
moved in previous fifty consecutive moves, and the side to move didn't claim
a draw.
</p>

<h3 id="position:initial">:initial</h3>

<p>
This is the first position in the game (before first move). In fact this is
an alternative notation for:
</p>

<div class='verb'><code>
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:halfmovenumber">:halfmovenumber</span></a> 0
</code></div>

<p>
This keyword can be used in a negated form; with a preceding exclamation
mark. Example:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'>!<span class='keyword'>:initial</span></span>)
</code></div>

<p>
Match all positions except the first position in the game.
</p>

<p>
See also: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:halfmovenumber">:halfmovenumber</span></a>.
</p>

<h3 id="position:insidevariation">:insidevariation&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
This keyword matches if a position will be found inside a sub-variation. This cannot
happen as long as <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:variations">:variations</span></a> is not used to include sub-variations.
</p>

<p>
This keyword can be used in a negated form; with a preceding exclamation
mark. Example:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'>!<span class='keyword'>:insidevariation</span></span>)
</code></div>

<p>
This position is not found inside a sub-variation.
</p>

<p>
See also: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:variations">:variations</span></a>.
</p>

<h3 id="position:losing">:losing&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
Will match the final position if one side has lost all pieces.
This is possible only in Antichess games.
</p>

<p>
This keyword can be used in a negated form; with a preceding exclamation
mark. Example:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'>!<span class='keyword'>:losing</span></span>)
</code></div>

<p>
Only match positions where neither side has lost all pieces.
</p>

<h3 id="position:mate">:mate</h3>

<p>
Match only if the position is a mate.
</p>

<div class='annotation'><img src='../images/annotation.png' style='float:left; margin:0 1em 0 0' alt='annotation' />
When searching for mate positions this keyword should always be used even if
this keyword might be superfluous because other conditions are ensuring a
mate position, it is accelerating the search (only testing final positions).
</div>

<p>
This keyword can be used in a negated form; with a preceding exclamation
mark. Example:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'>!<span class='keyword'>:mate</span></span>)
</code></div>

<p>
Exclude all checkmate positions.
</p>

<p>
One more example:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:mate</span></span> <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:movenumber">:movenumber</span></a> 1 20)
</code></div>

<p>
Only matches if one side is mated in first 20 moves.
</p>

<p>
See also: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:ismate">:ismate</span></a>.
</p>

<h3 id="position:matingmaterial">:matingmaterial&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
Match a position if either player has mating material (&#x21d2;
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:nomatingmaterial">:nomatingmaterial</span></a>). In chess variant
Three-check Chess this search cannot match as
soon as only kings are on board. In all other chess variants
(except Three-check Chess, and Normal Chess)
this keyword is meaningless and always successful.
</p>

<p>
This keyword can be used in a negated form; with a preceding exclamation
mark. Example:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'>!<span class='keyword'>:matingmaterial</span></span>)
</code></div>

<p>
Match positions where neither player has mating material. Normally this
query is equivalent to:
</p>

<div class='box'><pre><code><!--
--><span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:or">:or</span></a> (
  <span class='comment'>; king versus king</span>
  (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> <span class='cql' title='Any piece at all'>&#x25d1;</span> 2)
  <span class='comment'>; king and minor piece versus king</span>
  (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> <span class='cql' title='Any piece at all'>&#x25d1;</span> 3 <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> [<span class='cql' title='White minor piece'>&#x25bd;</span><span class='cql' title='Black minor piece'>&#x25bc;</span>] 1)
  <span class='comment'>; king and bishop versus king and bishop,</span>
  <span class='comment'>; both bishops are either light-squared, or dark-squared</span>
  (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> <span class='cql' title='Any piece at all'>&#x25d1;</span> 4 <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> [<span class='piece'>&#x2657;</span><span class='piece'>&#x265d;</span>]<span class='cql' title='Light squares'>&#x25a1;</span>? 2)
  (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> <span class='cql' title='Any piece at all'>&#x25d1;</span> 4 <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> [<span class='piece'>&#x2657;</span><span class='piece'>&#x265d;</span>]<span class='cql' title='Dark squares'>&#x25a0;</span>? 2))<!--
--></code></pre></div>

<p>
The negated form is always unsuccessful in all other chess variants than
Three-check Chess.
</p>

<h3 id="position:mustcapture">:mustcapture&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
In this position the side to move has the obligation to capture a piece
(this also means that a capture is possible). This keyword is provided
for chess variant Antichess, and cannot be successful
in all other chess variants.
</p>

<p>
This keyword can be used in a negated form; with a preceding exclamation
mark. Example:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'>!<span class='keyword'>:mustcapture</span></span>)
</code></div>

<p>
In this position the side to move ist not obligated to capture a piece
(this also means that a capture is not possible at all). This condition
will be always fulfilled in other chess variants than
Antichess.
</p>

<p>
See also: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:mustcapture">:mustcapture</span></a>,
</p>

<h3 id="position:nocheck">:nocheck</h3>

<p>
This keyword is deprecated and should not be used anymore. It will be
supported only for compatibility reasons, ans has the same meaning as
the expression <span style='white-space:nowrap;'>!<a href="CQL-Position-List.html#position:check">:check</span></a>.
</p>

<h3 id="position:stalemate">:stalemate</h3>

<p>
Match only if the position is a stalemate.
</p>

<p>
This keyword can be used in a negated form; with a preceding exclamation
mark. Example:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'>!<span class='keyword'>:stalemate</span></span>)
</code></div>

<p>
Match only if the position is not stalemate.
</p>

<p>
See also: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:isstalemate">:isstalemate</span></a>,
</p>

<h3 id="position:terminal">:terminal&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
This is the last position in the game (after last move). In fact this
is only an alternative form for:
</p>

<div class='verb'><code>
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:halfmovenumber">:halfmovenumber</span></a> end
</code></div>

<p>
This keyword can be used in a negated form; with a preceding exclamation
mark. Example:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'>!<span class='keyword'>:terminal</span></span>)
</code></div>

<p>
This is not the final position in the game.
</p>

<p>
See also: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:halfmovenumber">:halfmovenumber</span></a>.
</p>

<h3 id="position:threefoldrepetition">:threefoldrepetition&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
Match first position of mainline which occurred the third time in this game,
with same player to move, and each player has the same castling and en-passant
capturing rights. The repeated positions need not occur in succession. This
accords with the old
<!-- Note for translators: please replace with a localized web page -->
<a href="http://en.wikipedia.org/wiki/Threefold_repetition" target="blank_">threefold repetition rule&nbsp;<span class="awesome">&#xf08e;</span></a>.
</p>

<p>
Inside of sub-variants this keyword has no effect and will always fail.
</p>

<p>
This keyword can be used in a negated form; with a preceding exclamation
mark. Example:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'>!<span class='keyword'>:threefoldrepetition</span></span>)
</code></div>

<p>
Match any position which is not occurring the third time. If it is
not wanted to match positions after a threefold repetition has
occurred, then realize this with <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:cut">:cut</span></a>:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:threefoldrepetition</span></span> <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:cut">:cut</span></a>)
</code></div>

<h3 id="position:variations">:variations</h3>

<p>
Look in the variations to find matches. Without this keyword the variations
will be skipped.
</p>

<h3 id="position:variationsonly">:variationsonly</h3>

<p>
Look only in the variations to find matches, not in the main line.
</p>

<h3 id="position:whitecannotwin">:whitecannotwin&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
Match only if white cannot win in this position.
</p>

<p>
Normally this is equivalent to following query:
</p>

<div class='box'><pre><code><!--
--><span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:or">:or</span></a> (
  <span class='comment'>; white king only</span>
  (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> <span class='cql' title='Any white piece'>&#x25cb;</span> 1)
  <span class='comment'>; white king and white minor piece only</span>
  (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> <span class='cql' title='Any white piece'>&#x25cb;</span> 2 <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> <span class='cql' title='White minor piece'>&#x25bd;</span> 1))<!--
--></code></pre></div>

<p>
In chess variant Three-check Chess this query succeeds only if
white has no more pieces than the king, and in other chess variants this
query has no meaning and is always failing.
</p>

<p>
This keyword can be used in a negated form; with a preceding exclamation
mark. Example:
</p>
<div class='verb'><code>
(position <span style='white-space:nowrap;'>!<span class='keyword'>:whitecannotwin</span></span>)
</code></div>

<p>
Match all positions where the white player still has the option to win
(even if only theoretical).
</p>

<p>
See also: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:blackcannotwin">:blackcannotwin</span></a>
</p>

<h3 id="position:wtm">:wtm</h3>

<p>
Match only if white is to move.
</p>

<!-- ############################################################################## -->
<h2 id="transform">Transformation keywords</h2>
<!-- ############################################################################## -->

<table style="white-space:nowrap">
  <tr><td>&#x2022;</td><td><a href="#position:flip">:flip</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:flipcolor">:flipcolor</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:flipdiagonal">:flipdiagonal</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:flipdihedral">:flipdihedral</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:fliphorizontal">:fliphorizontal</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:flipvertical">:flipvertical</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:inside">:inside</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:shift">:shift</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:shiftdiagonal">:shiftdiagonal</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:shifthorizontal">:shifthorizontal</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:shiftmaindiagonal">:shiftmaindiagonal</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:shiftoffdiagonal">:shiftoffdiagonal</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:shiftvertical">:shiftvertical</a></td></tr>
</table>

<h3 id="position:flip">:flip</h3>

<p>
Same as <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:flipdihedral">:flipdihedral</span></a> (&#x21d2;
<a href="CQL-Transformations.html">Transformations</a>).
</p>

<h3 id="position:flipcolor">:flipcolor</h3>

<p>
The color flip transformation (&#x21d2;
<a href="CQL-Transformations.html">Transformations</a>).
</p>
<p>
This color flip transformation will have two effects: on one hand a flip
about the vertical bisector of the board
(&#x21d2; <a href="CQL-Transformations.html">Transformationen</a>)
and, on the other hand, a color flip: exchange white with black,
and black with white. This color flip transformation has no impact
to the match list <span style='white-space:nowrap;'><code>(match</code></span> <span style='white-space:nowrap;'><code>...)</code></span>
(<span style='white-space:nowrap;'><a href="CQL-Match-List.html#match:eithercolor">:eithercolor</span></span> : <span style='white-space:nowrap;'>match</span></a> is designated for this).
</p>

<h3 id="position:flipdiagonal">:flipdiagonal</h3>

<p>
The diagonal flip transformation (&#x21d2;
<a href="CQL-Transformations.html">Transformations</a>).
</p>

<h3 id="position:flipdihedral">:flipdihedral</h3>

<p>
All dihedral transformations (&#x21d2;
<a href="CQL-Transformations.html">Transformations</a>).
</p>

<h3 id="position:fliphorizontal">:fliphorizontal</h3>

<p>
The horizontal flip transformation (&#x21d2;
<a href="CQL-Transformations.html">Transformations</a>).
</p>

<h3 id="position:flipvertical">:flipvertical</h3>

<p>
The vertical flip transformation (&#x21d2;
<a href="CQL-Transformations.html">Transformations</a>).
</p>

<h3 id="position:inside">:inside&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
This keyword filters shift transformations in order to some matching pieces
will stay inside a specified region of the board. It takes two arguments, a
piece designator and a square designator. Any shift transformation affects
only the first argument. A shift transformation match <span style='white-space:nowrap;'>:inside</span>
limitation if at least one piece matching the first argument (taking into
account the transformation) is placed on a square matching the second argument.
</p>

<p>
The following examples are only demonstrations for the usage of
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:pawncount">:pawncount</span></a>. For the search of tripled pawns
the keyword <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:pawncount">:pawncount</span></a> is recommended.
</p>

<p>
We use the following query to find tripled pawns:
</p>

<div class='box'><pre><code><!--
-->(position
  <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> <span class='piece'>&#x2659;</span>[b2-7] 3
  <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:shifthorizontal">:shifthorizontal</span></a>)<!--
--></code></pre></div>

<p>
To find one of tripled pawns placed on the main diagonal we design the query
</p>

<div class='box'><pre><code><!--
-->(position
  <span style='white-space:nowrap;'><span class='keyword'>:inside</span></span> <span class='piece'>&#x2659;</span>[b2-7] [b2,c3,d4,e5,f6,g7]
  <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> <span class='piece'>&#x2659;</span>[b2-7] 3
  <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:shifthorizontal">:shifthorizontal</span></a>)<!--
--></code></pre></div>

<h3 id="position:shift">:shift</h3>

<p>
The shift transformations (&#x21d2;
<a href="CQL-Transformations.html">Transformations</a>).
</p>

<h3 id="position:shiftdiagonal">:shiftdiagonal</h3>

<p>
The off-diagonal and main-diagonal shift transformations (&#x21d2;
<a href="CQL-Transformations.html">Transformations</a>).
</p>

<h3 id="position:shifthorizontal">:shifthorizontal</h3>

<p>
The horizontal shift transformations (&#x21d2;
<a href="CQL-Transformations.html">Transformations</a>).
</p>

<h3 id="position:shiftmaindiagonal">:shiftmaindiagonal</h3>

<p>
The main-diagonal shift transformations (&#x21d2;
<a href="CQL-Transformations.html">Transformations</a>).
</p>

<h3 id="position:shiftoffdiagonal">:shiftoffdiagonal</h3>

<p>
The off-diagonal shift transformations (&#x21d2;
<a href="CQL-Transformations.html">Transformations</a>).
</p>

<h3 id="position:shiftvertical">:shiftvertical</h3>

<p>
The vertical shift transformations (&#x21d2;
<a href="CQL-Transformations.html">Transformations</a>).
</p>

<!-- ############################################################################## -->
<h2 id="piece">Piece configuration keywords</h2>
<!-- ############################################################################## -->

<table style="white-space:nowrap">
  <tr><td>&#x2022;</td><td><a href="#position:attackcount">:attackcount</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:goodbishop">:goodbishop</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:opposition">:opposition</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:pawncount">:pawncount</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:pawncountdifference">:pawncountdifference</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:piececount">:piececount</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:piececountdifference">:piececountdifference</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:power">:power</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:powerdifference">:powerdifference</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:ray">:ray</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:rayattack">:rayattack</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:raydiagonal">:raydiagonal</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:rayhorizontal">:rayhorizontal</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:rayorthogonal">:rayorthogonal</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:rayvertical">:rayvertical</a></td></tr>
</table>

<h3 id="position:attackcount">:attackcount</h3>

<p>
This keyword takes as arguments two piece designators followed by a
<a href="CQL-Range-Specifiers.html">range specifier</a>. The first piece
designator is the attacker piece designator. The second piece designator
is the attacked piece designator. An attack by a piece to a square occurs
if the piece could move to that square were it empty and disregarding any
possible checks. A valid attack is an attack by a piece on a square that
matches the attacker piece designator to a square on which is a piece that
matches the attacking piece designator.
</p>

<p>
The <span style='white-space:nowrap;'>:attackcount</span> keyword matches a position if the total number
of valid attacks in the position lies with the range given by its range
specifier.
</p>

<p>
Examples:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:attackcount</span></span> <span class='cql' title='Any white piece'>&#x25cb;</span> <span class='piece'>&#x265a;</span> 2)
</code></div>

<p>
Will match any position in which white has a double attack on the black king
(note that the use of <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:doublecheck">:doublecheck</span></a> combined with
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:btm">:btm</span></a> should be preferred).
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:attackcount</span></span> <span class='cql' title='Any white piece'>&#x25cb;</span> <span class='piece'>&#x265a;</span> 2 <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:flipcolor">:flipcolor</span></a>)
</code></div>

<p>
Will match any position in which a king is under double attack
(again the use of <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:doublecheck">:doublecheck</span></a> should be preferred).
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:attackcount</span></span> <span class='cql' title='Any white piece'>&#x25cb;</span> .h3 1)
</code></div>

<p>
Will match a position in which exactly one white piece attacks an empty h3 square.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:attackcount</span></span> [<span class='piece'>&#x2656;</span><span class='piece'>&#x2657;</span>][a-c8] ??1 5 9
</code></div>

<p>
Will match a position in which the number of times a white rook or white bishop
on a8, b8, or c8 attacks a square on the first rank is between 5 and 9
inclusive.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:attackcount</span></span> <span class='piece'>&#x265e;</span> [<span class='piece'>&#x2654;</span><span class='piece'>&#x2656;</span><span class='piece'>&#x2655;</span>] &gt;=3)
</code></div>

<p>
Will match position for which the number of times a black knight attacks a white
King or white major piece is at least 3.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:attackcount</span></span> [<span class='piece'>&#x2654;</span><span class='piece'>&#x265a;</span>] . 0)
</code></div>

<p>
Both kings cannot move in this position.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:attackcount</span></span> <span class='cql' title='Any white piece'>&#x25cb;</span> ??8 0)
</code></div>

<p>
In this position no white piece can move onto the black back rank.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:attackcount</span></span> <span class='cql' title='Any piece at all'>&#x25d1;</span> ? 1)
</code></div>

<p>
Only one move is possible in this position.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:attackcount</span></span> [<span class='piece'>&#x2658;</span><span class='piece'>&#x265e;</span>][+] . 0)
</code></div>

<p>
No knight can be dropped in this position
(Drop Chess, Bughouse Chess).
</p>

<h3 id="position:goodbishop">:goodbishop&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
Match positions with at least one bishop which is rated <i>good</i> or
<i>bad</i>. This keyword expects a piece designator as first argument,
containing only bishops. Then either two
<a href="CQL-Range-Specifiers.html">range specifiers</a>, or two
<a href="CQL-Percentage-Specifiers.html">percentage range specifiers</a>
will follow. The first one is denoting the count or the percentage of
the opposing pawns &ndash; the percentage refers to the total count
of opposing pawns &ndash; and the second range is the count or the
percentage of all own pawns which are not blockading the bishop
&ndash; in this case the percentage refers to the total count of
own pawns. Both ranges will be applied for each bishop individually.
The ranges must be separated by symbol <span style='white-space:nowrap;'><code>:</code></span>.
</p>

<p>
Examples:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:goodbishop</span></span> <span class='piece'>&#x2657;</span>[<span class='cql' title='Dark squares'>&#x25a0;</span>?] &gt;50% : &gt;50%)
</code></div>

<p>
White has at least one <i>good</i> dark-squared bishop, because more than
50% of the opposing pawns are dark-squared (thus attackable), and more
than 50% of the own pawns are light-squared (thus not blocking the bishop).
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:goodbishop</span></span> <span class='piece'>&#x2657;</span> &gt;50% : &gt;50%)
</code></div>

<p>
White has at least one <i>good</i> bishop.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:goodbishop</span></span> [<span class='piece'>&#x2657;</span><span class='piece'>&#x265d;</span>] &lt;=30% : &lt;=20%)
</code></div>

<p>
One side has a <i>bad</i> bishop.
</p>

<h3 id="position:opposition">:opposition&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
This keyword is matching all positions where the specified king has the
opposition. It takes a piecetype designator as an optional argument, where
the piecetypes have the following meaning:
</p>

<ul style='list-style-type: none'><li>
  <table>
    <tr>
      <td class="l"><span style='white-space:nowrap;'><code><span class='piece'>&#x2654;</span></code></span></td>
      <td class="r">White king has opposition to black king.</td>
    </tr>
    <tr>
      <td class="l"><span style='white-space:nowrap;'><code><span class='piece'>&#x265a;</span></code></span></td>
      <td class="r">Black king has opposition to white king.</td>
    </tr>
  </table>
</li></ul>

<p>
If no piecetype designator is given, the king of the side to move will
be investigated.
</p>

<p>
The use of this keyword is appropriate only in certain endgame situations,
to check whether the king is in opposition again, for example. Whether a king
has the opposition will be decided with a purely formal computation over
the distance of the kings, considering the side to move, but disregarding
all other pieces on the board, even possible checks will no be taken into
consideration. Hence the following example would match even the start
position:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:opposition</span></span> <span class='piece'>&#x2654;</span>)
</code></div>

<!-- ========================================================= -->
<h3 id="position:pawncount">:pawncount&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
<span style='white-space:nowrap;'>:pawncount</span> serves for counting pawn structures or pawn attributes.
The first argument is a piece designator, which contains only pawns, followed
by a hyphen-separated enumeration of attributes. The last argument is either
a <a href="CQL-Range-Specifiers.html">range specifier</a>, or a
<a href="CQL-Percentage-Specifiers.html">percentage range specifier</a>.
The percentage specification refers to the total count of pawns on the board
with the same color as specified in the piece designator. This keyword
is matching if the distribution of those pawns, fulfilling all the given
attributes, is inside the specified range.
</p>

<p>
The supported pawn structures and pawn attributes are:
</p>

<div class='box'>
  <table style="margin-top:5px;margin-bottom:5px">
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>single</code></span></td>
      <td class="r">Count one pawn if this is the sole pawn on a line
                    of this color.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>double</code></span></td>
      <td class="r">Count two pawns if at least two pawns of the same color
                    are in the same line.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>double!</code></span></td>
      <td class="r">Count two pawns if exact two pawns of the same color
                    are in the same line.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>triple</code></span></td>
      <td class="r">Count three pawns if at least three pawns of the same color
                    are in the same line.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>triple!</code></span></td>
      <td class="r">Count three pawns if exact three pawns of the same color
                    are in the same line.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>triple(n)</code></span></td>
      <td class="r">Count n pawns if at least n pawns of the same color
                    are in the same line.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>triple!(n)</code></span></td>
      <td class="r">Count n pawns if exact n pawns of the same color
                    are in the same line.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>uno</code></span></td>
      <td class="r">Count one pawn if this is the sole pawn on a file
                    of this color.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>duo</code></span></td>
      <td class="r">Count two pawns if at least two pawns of the same color
                    are in the same file.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>duo!</code></span></td>
      <td class="r">Count two pawns if exact two pawns of the same color
                    are in the same file.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>trio</code></span></td>
      <td class="r">Count three pawns if at least three pawns of the same color
                    are in the same file.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>trio!</code></span></td>
      <td class="r">Count three pawns if exact three pawns of the same color
                    are in the same file.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>quart</code></span></td>
      <td class="r">Count four pawns if at least four pawns of the same color
                    are in the same file.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>quart!</code></span></td>
      <td class="r">Count four pawns if exact four pawns of the same color
                    are in the same file.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>quart(n)</code></span></td>
      <td class="r">Bauern verbunden in einer Reihe: es werden alle verbundenen Bauern
                    auf einer Reihe gezÃ¤hlt, wenn mindestens n Bauern zu diesem Verbund
                    gehÃ¶ren.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>quart!(n)</code></span></td>
      <td class="r">Bauern verbunden in einer Reihe (exakt): es werden alle
                    verbundenen Bauern auf einer Reihe gezÃ¤hlt, wenn genau n
                    Bauern zu diesem Verbund gehÃ¶ren.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>connected</code></span></td>
      <td class="r">Verbundene Bauern: es werden alle Bauern gezÃ¤hlt, die einen
                    Bauern der gleichen Farbe auf einer benachbarten Linie haben.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>integrated</code></span></td>
      <td class="r">Integrierte Bauern: es werden alle Bauern gezÃ¤hlt, die
                    auf allen Nachbarslinien Bauern der gleichen Farbe
                    haben.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>isolated</code></span></td>
      <td class="r">Isolierte Bauern (Isolani): es werden alle Bauern gezÃ¤hlt,
                    die keinen Bauern gleicher Farbe auf einer benachbarten
                    Linie haben.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>halfisolated</code></span></td>
      <td class="r">Halb-isolierte Bauern: es werden alle Bauern gezÃ¤hlt,
                    die auf einer benachbarten Linie mindstens einen
                    gleichfarbigen Bauern haben, aber keinen auf der anderen
                    benachbarten Linie. Ein Randbauer kann niemals
                    halb-isoliert sein.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>defended</code></span></td>
      <td class="r">Verteidigte Bauern: es werden alle Bauern gezÃ¤hlt, die von
                    einem Bauern der gleichen Farbe gedeckt werden (auch wenn
                    sie nicht angegriffen sind).</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>defender</code></span></td>
      <td class="r">Verteidigende Bauern: es werden alle Bauern gezÃ¤hlt, die
                    einen Bauern der gleichen Farbe decken (auch wenn der
                    gedeckte Bauer nicht angegriffen ist).</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>chained</code></span></td>
      <td class="r">Bauernkette: es werden alle Bauern gezÃ¤hlt, die sich mit
                    gleichfarbigen Bauern auf einer SchrÃ¤ge befinden (sie
                    sind verbunden, und bis auf den hintersten sind alle
                    gedeckt).</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>chained(n)</code></span></td>
      <td class="r">Bauernkette: es werden alle Bauern gezÃ¤hlt, die sich mit
                    gleichfarbigen Bauern auf einer SchrÃ¤ge befinden (sie
                    sind verbunden, und bis auf den hintersten sind alle
                    gedeckt), aber nur wenn sich in diesem Verbund mindestens
                    n Bauern befinden.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>chained!(n)</code></span></td>
      <td class="r">Bauernkette: es werden alle Bauern gezÃ¤hlt, die sich mit
                    gleichfarbigen Bauern auf einer SchrÃ¤ge befinden (sie
                    sind verbunden, und bis auf den hintersten sind alle
                    gedeckt), aber  nur wenn sich in diesem Verbund genau
                    n Bauern befinden.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>passed</code></span></td>
      <td class="r">Freibauern: es werden alle Bauern gezÃ¤hlt, die keinen
                    gegnerischen Bauer auf der gleichen Linie haben, und
                    von keinem gegnerischen Bauern auf einer benachbarten
                    Linie gestoppt werden kÃ¶nnen.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>candidate</code></span></td>
      <td class="r">Kandidaten: es werden alle Bauern gezÃ¤hlt, die keinen
                    gegnerischen Bauer auf der gleichen Linie vor sich haben,
                    und wenn die Anzahl der gleichfarbigen Bauern seitlich
                    des Bauern bzw. hinter dem Bauern auf benachbarten Linien
                    mindestens so groÃ ist wie die Anzahl der andersfarbigen
                    Bauern auf den benachbarten Linien in der VowÃ¤rtsrichtung
                    (somit ein Kanditat fÃ¼r einen Freibauern). Freibauern
                    (d.h. Bauern die keinen andersfarbigen Bauern auf den
                    Nachbarslinien begegnen) werden auch als Kandidat gezÃ¤hlt.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>candidate!</code></span></td>
      <td class="r">Kandidaten: Ein Kandidat fÃ¼r einen Freibauern, der jedoch
                    noch kein Freibauer ist.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>blocked</code></span></td>
      <td class="r">Blockierte Bauern: zÃ¤hlt alle Bauern, denen auf der gleichen
                    Linie ein gegnerischer Bauer gegenÃ¼bersteht.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>blocked!</code></span></td>
      <td class="r">Blockierte Bauern (unmittelbar): zÃ¤hlt alle Bauern, denen
                    unmittelbar ein Bauer gegenÃ¼bersteht.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>behind</code></span></td>
      <td class="r">Bauern hinter dem Feind: zÃ¤hlt alle Bauern, die hinter
                    dem hintersten gegenerischen Bauer auf der gleichen Linie
                    stehen.  Z.B. kann ein weiÃer Bauer c7 hinter einem schwarzen
                    Bauer c5 stehen, wenn auch entfernt.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>behind!</code></span></td>
      <td class="r">Bauern unmittelbar hinter dem Feind: zÃ¤hlt alle Bauern, die
                    unmittelbar hinter dem hintersten gegenerischen Bauer auf der
                    gleichen Linie stehen. Z.B. kann ein weiÃer Bauer c7 unmittelbar
                    hinter einem schwarzen Bauer c6 stehen.</td>
    </tr>
    </tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>stoppable</code></span></td>
      <td class="r">Stoppbare Bauern: alle Bauern, die am WeiterrÃ¼cken bis
                    zur gegnerischen Grundreihe von einem gegnerischen Bauern
                    in einer benachbarten Linie gehindert werden.</td>
    </tr>
    </tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>stopped</code></span></td>
      <td class="r">Gestoppte Bauern: alle Bauern, die am WeiterrÃ¼cken von
                    einem gegnerischen Bauern, der in einer benachbarten Reihe
                    einer benachbarten Linie steht, gehindert werden.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>backward</code></span></td>
      <td class="r">RÃ¼ckstÃ¤ndige Bauern: alle Bauern, deren benachbarte Bauern
                    gleicher Farbe zu weit vorgerÃ¼ckt sind, um ihn decken zu
                    kÃ¶nnen. Isolierte Bauern sind niemals rÃ¼ckstÃ¤ndig.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>advanced</code></span></td>
      <td class="r">VorgerÃ¼ckte Bauern: alle Bauern, die bereits in der gegnerischen
                    HÃ¤lfte stehen.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>consecutive</code></span></td>
      <td class="r">Hintereinanderstehende Bauern: alle Bauern gleicher
                    Farbe, die auf einer Linie direkt hintereinander stehen,
                    werden gezÃ¤hlt.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>consecutive(n)</code></span></td>
      <td class="r">Hintereinanderstehende Bauern: mindestens n Bauern gleicher
                    Farbe, die auf einer Linie direkt hintereinander stehen,
                    werden gezÃ¤hlt.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>consecutive!(n)</code></span></td>
      <td class="r">Hintereinanderstehende Bauern: genau n Bauern gleicher
                    Farbe, die auf einer Linie direkt hintereinander stehen,
                    werden gezÃ¤hlt.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>inside</code></span></td>
      <td class="r">Einholbare Bauern: zÃ¤hlt die Bauern, die sich noch innerhalb
                    der Reichweite des gegnerischen KÃ¶nigs befinden.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>symmetrical</code></span></td>
      <td class="r">Symmetrische Bauernstruktur: zÃ¤hlt die Bauern, auf deren Linie
                    sich die gleiche Anzahl gegnerischer Bauern befindet.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>mirrored</code></span></td>
      <td class="r">Gespiegelte Bauernstruktur: zÃ¤hlt alle Bauern,
                    auf deren Linie alle gegnerischen Bauern auf horizontal
                    gespiegelten Feldern stehen.</td>
    </tr>
  </table>
</div>

<p>
Es muss mindestens eine dieser Bauerneigenschaften verwendet werden.
</p>

<p>
Alle Bauerneigenschaften kÃ¶nnen auch mit einem vorangestellten Ausrufungszeichen
negiert werden, dazu Beispiele:
</p>

<div class='verb'><code>
<span style='white-space:nowrap;'><span class='keyword'>:pawncount</span></span> <span class='piece'>&#x2659;</span> !blocked &gt;50%
</code></div>

<p>
Mehr als 50% der weiÃen Bauern stehen keine gegnerischen Bauern auf der gleichen Linie
gegenÃ¼ber.
</p>

<div class='verb'><code>
<span style='white-space:nowrap;'><span class='keyword'>:pawncount</span></span> <span class='piece'>&#x2659;</span> !blocked! &gt;50%
</code></div>

<p>
Mehr als 50% der weiÃen Bauern stehen keine gegnerischen Bauern auf der gleichen Linie
unmittelbar gegenÃ¼ber.
</p>

<div class='verb'><code>
<span style='white-space:nowrap;'><span class='keyword'>:pawncount</span></span> <span class='piece'>&#x2659;</span> !inside-passed &gt;0
</code></div>

<p>
Mindestens ein Freibauer ist nicht mehr innerhalb der Reichweite des gegnerischen
KÃ¶nigs.
</p>

<p>
Bemerkung: Das Attribut <span style='white-space:nowrap;'><code>passed</code></span> ist nur eine Kurzschreibweise:
</p>

<ul style='list-style-type: none'><li>
  <table style="margin-top:5px;margin-bottom:5px">
    <tr>
      <td class="l"><span style='white-space:nowrap;'><code>passed</code></span></td>
      <td class="m">=</td>
      <td class="r"><span style='white-space:nowrap;'><code>unblocked-unstoppable</code></span></td>
    </tr>
  </table>
</li></ul>

<p>
Jedoch ist <span style='white-space:nowrap;'><code>!passed</code></span> keine Kurzschreibweise.
</p>

<p>
Bemerkung: Das Attribut <span style='white-space:nowrap;'><code>candidate!</code></span> ist nur eine Kurzschreibweise:
</p>

<ul style='list-style-type: none'><li>
  <table style="margin-top:5px;margin-bottom:5px">
    <tr>
      <td class="l"><span style='white-space:nowrap;'><code>candidate!</code></span></td>
      <td class="m">=</td>
      <td class="r"><span style='white-space:nowrap;'><code>candidate-!passed</code></span></td>
    </tr>
  </table>
</li></ul>

<p>
Die folgenden Attribute, die ebenfalls mit einem vorangestellten Ausrufungszeichen
negiert werden kÃ¶nnen, schrÃ¤nken die Sichtweise auf die Bauern ein:
</p>

<div class='box'>
  <table style="margin-top:5px;margin-bottom:5px">
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>forefront</code></span></td>
      <td class="r">Vorhut: nur die vordersten Bauern auf einer Linie
                    werden untersucht.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>rear</code></span></td>
      <td class="r">Nachhut: nur die hintersten Bauern auf einer Linie
                    werden untersucht.</td>
    </tr>
  </table>
</div>

<p>
Die Position von <span style='white-space:nowrap;'><code>forefront</code></span> bzw. <span style='white-space:nowrap;'><code>rear</code></span> innerhalb der
Liste der Eigenschaften beeinfluÃt, fÃ¼r welche Attribute die Sichtweise
eingeschrÃ¤nkt wird. Beispiel:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:pawncount</span></span> double!-forefront-duo &gt;0)
</code></div>

<p>
Dies findet nebeneinanderstehende Doppelbauern gleicher Farbe auf, wobei sie
auf den gleichen Reihen stehen mÃ¼ssen. <span style='white-space:nowrap;'><code>forefront</code></span> muÃ nach
<span style='white-space:nowrap;'><code>double!</code></span> verwendet werden, ansonsten ist kein Doppelbauer
auffindbar (tatsÃ¤chlich meldet die Applikation dann einen Fehler). Die
Reihenfolge zu <span style='white-space:nowrap;'><code>duo</code></span> spielt hier keine Rolle.
</p>

<p>
Die unterstÃ¼tzen Attribute fÃ¼r die Modifikation der ZÃ¤hlweise sind:
</p>

<div class='box'>
  <table style="margin-top:5px;margin-bottom:5px">
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>islands</code></span></td>
      <td class="r">Bauerninseln: zÃ¤hle alle Bauerninseln (nicht die Anzahl der
                    Bauern, die zu den Inseln gehÃ¶ren). Eine Bauerninsel besteht
                    aus einem Bauernverbund gleicher Farbe, die jeweils alle auf
                    benachbarten Linien stehen. Zwischen gleichfarbigen Inseln
                    kann sich also kein Bauer gleicher Farbe befinden.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>islands(n)</code></span></td>
      <td class="r">Bauerninseln: zÃ¤hle alle Bauerninseln (nicht die Anzahl der
                    Bauern, die zu den Inseln gehÃ¶ren). Eine Bauerninsel besteht
                    aus einem Bauernverbund gleicher Farbe, die jeweils alle auf
                    benachbarten Linien stehen. Zwischen gleichfarbigen Inseln
                    kann sich also kein Bauer gleicher Farbe befinden. Es werden
                    jedoch nur die Inseln gezÃ¤hlt, zu denen jeweils mindestens
                    n Bauern gehÃ¶ren.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>islands!(n)</code></span></td>
      <td class="r">Bauerninseln: zÃ¤hle alle Bauerninseln (nicht die Anzahl der
                    Bauern, die zu den Inseln gehÃ¶ren). Eine Bauerninsel besteht
                    aus einem Bauernverbund gleicher Farbe, die jeweils alle auf
                    benachbarten Linien stehen. Zwischen gleichfarbigen Inseln
                    kann sich also kein Bauer gleicher Farbe befinden. Es werden
                    jedoch nur die Inseln gezÃ¤hlt, zu denen jeweils genau
                    n Bauern gehÃ¶ren.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>compounds</code></span></td>
      <td class="r">BauernverbÃ¼nde: zÃ¤hle alle BauernverbÃ¼nde (nicht die Anzahl der
                    Bauern, die zu dem Verbund gehÃ¶ren). Eine Bauernverbund besteht
                    aus Bauern gleicher Farbe, die jeweils alle auf benachbarten Reihen
                    stehen. Zwischen gleichfarbigen VerbÃ¼nden kann sich also kein Bauer
                    gleicher Farbe befinden.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>compounds(n)</code></span></td>
      <td class="r">BauernverbÃ¼nde: zÃ¤hle alle BauernverbÃ¼nde (nicht die Anzahl der
                    Bauern, die zu dem Verbund gehÃ¶ren). Eine Bauernverbund besteht
                    aus Bauern gleicher Farbe, die jeweils alle auf benachbarten Reihen
                    stehen. Zwischen gleichfarbigen VerbÃ¼nden kann sich also kein Bauer
                    gleicher Farbe befinden. Es werden jedoch nur die VerbÃ¼nde gezÃ¤hlt,
                    zu denen jeweils mindestens n Bauern gehÃ¶ren</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>compounds!(n)</code></span></td>
      <td class="r">BauernverbÃ¼nde: zÃ¤hle alle BauernverbÃ¼nde (nicht die Anzahl der
                    Bauern, die zu dem Verbund gehÃ¶ren). Eine Bauernverbund besteht
                    aus Bauern gleicher Farbe, die jeweils alle auf benachbarten Reihen
                    stehen. Zwischen gleichfarbigen VerbÃ¼nden kann sich also kein Bauer
                    gleicher Farbe befinden. Es werden jedoch nur die VerbÃ¼nde gezÃ¤hlt,
                    zu denen jeweils genau n Bauern gehÃ¶ren</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>files</code></span></td>
      <td class="r">Bauer pro Linie: zÃ¤hle alle Linien (nicht die Bauern auf den
                    Linien), auf denen sich Bauern mit den genannten Eigenschaften
                    befinden.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>files(n)</code></span></td>
      <td class="r">Bauer pro Linie: zÃ¤hle alle Linien (nicht die Bauern auf den
                    Linien), auf denen sich mindestens n Bauern mit den genannten
                    Eigenschaften befinden.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>files!(n)</code></span></td>
      <td class="r">Bauer pro Linie: zÃ¤hle alle Linien (nicht die Bauern auf den
                    Linien), auf denen sich genau n Bauern mit den genannten
                    Eigenschaften befinden.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>ranks</code></span></td>
      <td class="r">Bauer pro Reihe: zÃ¤hle alle Reihen (nicht die Bauern auf den
                    Linien), auf denen sich Bauern mit den genannten Eigenschaften
                    befinden.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>ranks(n)</code></span></td>
      <td class="r">Bauer pro Reihe: zÃ¤hle alle Reihen (nicht die Bauern auf den
                    Linien), auf denen sich mindestens n Bauern mit den genannten
                    Eigenschaften befinden.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>ranks!(n)</code></span></td>
      <td class="r">Bauer pro Reihe: zÃ¤hle alle Reihen (nicht die Bauern auf den
                    Linien), auf denen sich genau n Bauern mit den genannten
                    Eigenschaften befinden.</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>bothsides</code></span></td>
      <td class="r">Beide FlÃ¼gel: das Resultat der ZÃ¤hlung ist das Minimum der
                    Bauernzahl auf dem DamenflÃ¼gel (a-d) und der Bauernzahl auf dem
                    KÃ¶nigsflÃ¼gel <span style='white-space:nowrap;'>(e-h).</span></td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>oneside</code></span></td>
      <td class="r">Ein FlÃ¼gel: entweder wird Null gezÃ¤hlt, wenn kein Bauer vorhanden
                    ist, bzw. wenn mindestens ein Bauer sowohl auf dem DameflÃ¼gel
                    <span style='white-space:nowrap;'>(a-d)</span> als auch auf dem KÃ¶nigsflÃ¼gel <span style='white-space:nowrap;'>(e-h)</span>
                    vorhanden ist, ansonsten wird die Gesamtzahl der Bauern gezÃ¤hlt.</td>
    </tr>
  </table>
</div>

<p>
Eine ZÃ¤hlung erfolgt immer am SchluÃ, nachdem aller Bauern mit den gewÃ¼nschten
Eigenschaften aufgefunden wurden. Damit dies klarer beim Lesen des Ausdrucks
wird, dÃ¼rfen Attribute fÃ¼r die ZÃ¤hlung nur am Ende einer Attributliste
verwendet werden.
</p>

<p>
Die Attribute fÃ¼r die ZÃ¤hlweise haben keinen EinfluÃ auf die Auswahl der gezÃ¤hlten
Bauern. Sobald beispielsweise <span style='white-space:nowrap;'><code>islands</code></span> in einer VerknÃ¼pfung verwendet wird,
werden immer die Anzahl der Insel gezÃ¤hlt. Dazu Beispiele:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:pawncount</span></span> [<span class='piece'>&#x2659;</span><span class='piece'>&#x265f;</span>] trio-islands)
</code></div>

<p>
Nun wird die Anzahl aller Bauerntrios gezÃ¤hlt, nicht mehr die Anzahl der beteiligten
Bauern.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:pawncount</span></span> [<span class='piece'>&#x2659;</span><span class='piece'>&#x265f;</span>] chained-islands)
</code></div>

<p>
Die Anzahl der Bauernketten wird gezÃ¤hlt, nicht die Anzahl der beteiligten Bauern.
</p>

<p>
Manche dieser Attribute kÃ¶nnen ein ZÃ¤hler als Argument haben. Der ZÃ¤hler muÃ den
Wertebereich einhalten:
</p>

<div class='box'>
  <table style="margin-top:5px;margin-bottom:5px">
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>compounds, compounds!, ranks, ranks!</code></span></td>
      <td class="r">1 &#x2264; n &#x2264; 6</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>islands, islands!, files, files!</code></span></td>
      <td class="r">1 &#x2264; n &#x2264; 8</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>consecutive, consecutive!</code></span></td>
      <td class="r">2 &#x2264; n &#x2264; 6</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>chained, chained!</code></span></td>
      <td class="r">2 &#x2264; n &#x2264; 8</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>triple, triple!</code></span></td>
      <td class="r">3 &#x2264; n &#x2264; 6</td>
    </tr>
    <tr>
      <td class="l" valign="top"><span style='white-space:nowrap;'><code>quart, quart!</code></span></td>
      <td class="r">4 &#x2264; n &#x2264; 8</td>
    </tr>
  </table>
</div>

<p>
GrundsÃ¤tzlich kÃ¶nnen alle Attribute miteinander verknÃ¼pft werden,
jedoch sind nicht alle VerknÃ¼pfungen sinnvoll. Es erfolgt eine Fehlermeldung,
wenn sich in einer VerknÃ¼pfung Attribute widersprechen (wie z.B. bei
<span style='white-space:nowrap;'><code>chained-isolated</code></span>, oder <span style='white-space:nowrap;'><code>mirrored-unblocked</code></span>).
</p>

<p>
Die Attribute wirken als Filter, d.h. jedes Attribut filtert die Bauern mit
der spezifizierten Eigenschaft, und das nachfolgende Attribut filtert dann
die verbliebenen Bauern aus der vorhergehenden ZÃ¤hlung. Daraus resultiert,
daÃ die Reihenfolge der verknÃ¼pften Attribute generell eine Rolle spielt,
so sind die folgenden Beispiele nicht Ã¤quivalent:
</p>

<div class='verb'><code><span style='white-space:nowrap;'><span class='keyword'>:pawncount</span></span> single-behind &gt;0</code></div>
<div class='verb'><code><span style='white-space:nowrap;'><span class='keyword'>:pawncount</span></span> behind-single &gt;0</code></div>

<p>
Im ersten Fall kÃ¶nnen tatsÃ¤chlich nur dann Bauern auf einer Linie gezÃ¤hlt
werden, wenn es keinen weiteren der gleichen Farbe auf dieser Linie gibt,
aber im zweiten Fall wÃ¼rde <span style='white-space:nowrap;'><code>behind</code></span> evt. nur Bauern zurÃ¼cklassen
(filtern), die dann ganz alleine auf der Linie sind (gegnerische Bauern
werden nicht berÃ¼cksichtigt), und diese werden dann alle als Einzelbauern
gezÃ¤hlt. Diese Methodik mit der Filterung erlaubt mehr EinfluÃmÃ¶glichkeiten
auf die ZÃ¤hlung als eine einfache Und-VerknÃ¼pfung.
</p>

<p>
Weitere Beispiele:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:pawncount</span></span> <span class='piece'>&#x2659;</span> blocked 100%)
</code></div>

<p>
Alle weiÃen Bauern sind blockiert, d.h. jedem weiÃen Bauern steht ein schwarzer
Bauer (mÃ¶glicherweise entfernt) gegenÃ¼ber.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:pawncount</span></span> [<span class='piece'>&#x2659;</span><span class='piece'>&#x265f;</span>][a-d?] blocked 100%)
</code></div>

<p>
Alle Bauern auf dem DamenflÃ¼gel sind blockiert, d.h. jedem Bauern auf dem DamenflÃ¼gel
steht ein gegnerischer Bauer (mÃ¶glicherweise entfernt) gegenÃ¼ber.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:pawncount</span></span> <span class='piece'>&#x2659;</span>[a-d?] blocked! &gt;=50%)
</code></div>

<p>
Mindestens der HÃ¤lfte der weiÃen Bauern auf dem DamenflÃ¼gel steht ein schwarzer
Bauer direkt gegenÃ¼ber (dies kann niemals zutreffen, wenn es keine weiÃen Bauern
auf dem DamenflÃ¼gel gibt).
</p>

<div class='box'><pre><code><!--
-->(position
  <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:flipcolor">:flipcolor</span></a>
  <span style='white-space:nowrap;'><span class='keyword'>:pawncount</span></span> <span class='piece'>&#x2659;</span> double-!advanced-compounds &gt;=2)<!--
--></code></pre></div>

<p>
Einer der Parteien hat mindestens zwei Doppelbauern, wobei keiner
der betroffenen Bauern in der gegnerischen HÃ¤lfte steht.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:pawncount</span></span> [<span class='piece'>&#x2659;</span><span class='piece'>&#x265f;</span>] isolated-consecutive(3) &gt;=3)
</code></div>

<p>
Findet isolierte Trippelbauern auf verbundenen Feldern, wie in folgender
Stellung:
</p>

<div id="tooltip1" style="margin-top:-8px">
<a><span style='white-space:nowrap;'><code>8/p4pk1/8/2R1P1N1/6P1/6P1/2P2KP1/1r5r w - - 0 1</code></span><img
  src="../images/cql-examples-1.png" height="241" width="241" alt=""/></a>
</div>

<p>
Die Alternative
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:pawncount</span></span> [<span class='piece'>&#x2659;</span><span class='piece'>&#x265f;</span>] isolated-triple-consecutive &gt;=3)
</code></div>

<p>
wÃ¤re hier nicht das gewÃ¼nschte, denn in diesem Fall werden beispielsweise auch
Trippelbauern gezÃ¤hlt, die nicht allesamt miteinander verbunden sind,
beispielsweise zwei isolierte Doppelbauern auf einer Linie. Wird jedoch
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:pawncount</span></span> [<span class='piece'>&#x2659;</span><span class='piece'>&#x265f;</span>] isolated-triple!-consecutive &gt;=3)
</code></div>

<p>
verwendet, dann werden zwar wieder hintereinanderstehende isolierte Trippelbauern
gefunden, aber keine Stellungen mit mehr als drei hintereinanderstehenden isolierten
Bauern. Aber in diesem speziellen Beispiel ist die folgende alternative Formulierung
Ã¤quivalent zu <span style='white-space:nowrap;'><code>isolated-consecutive(3)</code></span>:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:pawncount</span></span> [<span class='piece'>&#x2659;</span><span class='piece'>&#x265f;</span>] isolated-triple-compounds(3) &gt;0)
</code></div>

<p>
Hier ist das Attribut <span style='white-space:nowrap;'><code>triple</code></span> redundant, macht aber die Sache einfacher
lesbar.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:pawncount</span></span> [<span class='piece'>&#x2659;</span><span class='piece'>&#x265f;</span>] backward-stopped-!blocked &gt;0)
</code></div>

<p>
Einer der Parteien hat mindestens einen rÃ¼ckstÃ¤ndigen Bauern, der keinen gegnerischen
Bauern auf der gleichen Linie vor ihm hat, aber von einem gegnerischen Bauer auf einer
benachbarten Linie in direkter Weise am VorÃ¼cken gehindert wird.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:pawncount</span></span> <span class='piece'>&#x2659;</span>?4 stoppable-!blocked-duo! &gt;0)
</code></div>

<p>
WeiÃ hat hÃ¤ngende Bauern auf der vierten Reihe: ein Bauerduo (zwei Bauern nebeneinander
auf einer Reihe), die sich auf halboffenen Linien befinden (d.h. sie sind nicht
blockiert, aber auch keine Freibauern).
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:pawncount</span></span> <span class='piece'>&#x265f;</span> bothsides 0)
</code></div>

<p>
Schwarz hat nicht mehr auf beiden FlÃ¼geln Bauern aufzuweisen.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:pawncount</span></span> <span class='piece'>&#x265f;</span> oneside &gt;0)
</code></div>

<p>
Schwarz hat alle seine Bauern entweder auf dem DamenflÃ¼gel oder auf
dem KÃ¶nigsflÃ¼gel, aber nicht auf beiden FlÃ¼geln.
</p>

<p>
Siehe bei <a href="CQL-Examples.html#pawnending">CQL-Beispiele</a> fÃ¼r weiter Beispiele.
</p>

<p>
See also:
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a>,
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:pawncountdifference">:pawncountdifference</span></a>,
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececountdifference">:piececountdifference</span></a>.
</p>

<h3 id="position:pawncountdifference">:pawncountdifference&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></span></h3>

<p>
<span style='white-space:nowrap;'>:pawncountdifference</span> filtert Positionen, wenn die Differenz
der ZÃ¤hlung von Bauern mit den spezifizierten Eigenschaften oder Strukturen
innerhalb der gegebenen Bereichsangabe liegt. Dieses SchlÃ¼sselwort kann
ein oder zwei Figurenbezeichner, die nur Bauern enthalten dÃ¼rfen, als Argumente
erhalten, gefolgt von einer bindestrich-separarierten AufzÃ¤hlung von Eigenschaften,
und als letztes Argument wird eine
<a href="CQL-Range-Specifiers.html">Bereichsangabe</a> erwartet. Ist nur ein
Figurenbezeichner gegeben, dann wird die Differenz des Resultats der ZÃ¤hlung der
weiÃen Figuren im Figurenbezeichner minus dem Resultat der ZÃ¤hlung der schwarzen
Figuren im Figurenbezeichner ermittelt. Bei der Angabe von zwei Figurenbezeichnern
wird die Differenz des Resultats der ZÃ¤hlung des ersten Figurenbezeichners minus
dem Resultat der ZÃ¤hlung des zweiten Figurenbezeichners ermittelt. Diese Differenz
muÃ innerhalb der Bereichsangabe liegen, damit eine Position gefiltert wird.
</p>

<p>
Die unterstÃ¼tzen Bauerneigenschaften bzw. Bauernstruktureigenschaften sind
die gleichen wie unter <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:pawncount">:pawncount</span></a>.
</p>

<p>
Beispiele:
</p>

<div class='box'><pre><code><!--
-->(position
  <span style='white-space:nowrap;'><span class='keyword'>:pawncountdifference</span></span> <span class='piece'>&#x2659;</span>[?5-7] <span class='piece'>&#x265f;</span>[?2-4] passed-lines &gt;0)<!--
--></code></pre></div>

<p>
WeiÃ hat mehr Freibauern, die in der gegnerischen HÃ¤lfte stehen, als Schwarz. Es
werden hier jedoch fÃ¼r jede Farbe nur ein Freibauer pro Linie gezÃ¤hlt (in diesem
speziellen Fall kÃ¶nnte statt <span style='white-space:nowrap;'><code>lines</code></span> auch <span style='white-space:nowrap;'><code>forefront</code></span>
verwendet werden).
</p>

<p>
See also:
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:pawncount">:pawncount</span></a>,
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a>,
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececountdifference">:piececountdifference</span></a>.
</p>

<h3 id="position:piececount">:piececount</h3>

<p>
This keyword takes a piece designator argument followed by a
<a href="CQL-Range-Specifiers.html">range specifier</a>. It matches the
position if and only if the number of occurrences of the piece designator
in the position is given by the range specifier.
</p>

<p>
Examples:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:piececount</span></span> <span class='piece'>&#x2656;</span> 2)
</code></div>

<p>
This will match any position with exactly two white rooks - a position with
three white rooks would fail to match.
</p>

<div class='box'><pre><code><!--
-->(position
  <span class='piece'>&#x2658;</span>d4
  <span style='white-space:nowrap;'><span class='keyword'>:piececount</span></span> [<span class='piece'>&#x2656;</span><span class='piece'>&#x265c;</span>][a1-8] 1 3
  <span style='white-space:nowrap;'><span class='keyword'>:piececount</span></span> [<span class='piece'>&#x2655;</span><span class='piece'>&#x265b;</span>][a-h8] 4)<!--
--></code></pre></div>

<p>
This will match any position with a white knight on d4, between one and three
rooks on the a file, and exactly four queens on the eight rank. Another way
to write this position list is:
</p>

<div class='box'><pre><code><!--
-->(position
  <span class='piece'>&#x2658;</span>d4
  <span style='white-space:nowrap;'><span class='keyword'>:piececount</span></span> [<span class='piece'>&#x2656;</span><span class='piece'>&#x265c;</span>][a?] 1 3
  <span style='white-space:nowrap;'><span class='keyword'>:piececount</span></span> [<span class='piece'>&#x2655;</span><span class='piece'>&#x265b;</span>][?8] 4)<!--
--></code></pre></div>

<h3 id="position:power">:power</h3>

<p>
This keyword takes as argument a piece designator followed by a
<a href="CQL-Range-Specifiers.html">range specifier</a>. It matches positions
for which the total power of all pieces in the position matching the piece
designator lies within the range specifier. The power of a piece is their
chess material power, depending on the
<a href="Chess-Variants.html">chess variant</a>:
</p>

<ul style='list-style-type: none'><li>
<table cellpadding="3">
  <tr>
    <td align="right"></td>
    <td align="right"><span class='chess'>&#x2654;</span></td>
    <td align="right"><span class='chess'>&#x2655;</span></td>
    <td align="right"><span class='chess'>&#x2656;</span></td>
    <td align="right"><span class='chess'>&#x2657;</span></td>
    <td align="right"><span class='chess'>&#x2658;</span></td>
    <td align="right"><span class='chess'>&#x2659;</span></td>
  </tr>
  <tr>
    <td>Normal Chess,
        Three-check Chess,
        King-of-the-Hill&emsp;</td>
    <td align="right"> 0</td>
    <td align="right"> 9</td>
    <td align="right"> 5</td>
    <td align="right"> 3</td>
    <td align="right"> 3</td>
    <td align="right"> 1</td>
  </tr>
  <tr>
    <td>Crazyhouse, Bughouse Chess&emsp;</td>
    <td align="right"> 0</td>
    <td align="right"> 5</td>
    <td align="right"> 3</td>
    <td align="right"> 3</td>
    <td align="right"> 3</td>
    <td align="right"> 1</td>
  </tr>
  <tr>
    <td>Losers&emsp;</td>
    <td align="right"> 0</td>
    <td align="right"> 5</td>
    <td align="right"> 4</td>
    <td align="right"> 3</td>
    <td align="right"> 4</td>
    <td align="right"> 1</td>
  </tr>
  <tr>
    <td>Suicide, Giveaway&emsp;</td>
    <td align="right">30</td>
    <td align="right"> 3</td>
    <td align="right"> 9</td>
    <td align="right"> 0</td>
    <td align="right"> 9</td>
    <td align="right"> 1</td>
  </tr>
</table>
</li></ul>

<p>
Examples:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:power</span></span> <span class='cql' title='Any black piece'>&#x25cf;</span> 6)
</code></div>

<p>
This will match positions in which the total power of the black pieces on the
board equals 6.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:power</span></span> <span class='cql' title='Any white piece'>&#x25cb;</span>[a-h1-4] 10 25)
</code></div>

<p>
This will match positions in which the total power of the white pieces on the
white half of the board is between 10 and 25 inclusive.
</p>

<h3 id="position:powerdifference">:powerdifference</h3>

<p>
This keyword takes as argument a piece designator followed by a
<a href="CQL-Range-Specifiers.html">range specifier</a>. It matches positions
in which the difference in power (&#x21d2; <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:power">:power</span></a>) between the
white and black pieces matching the piece designator (that is, the numeric value
of the power of the matching black pieces subtracted from the power of the
matching white pieces) lies within the range specifier.
</p>

<p>
A color flip by <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:flipcolor">:flipcolor</span></a> is negating the difference in
power.
</p>

<p>
Examples:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:powerdifference</span></span> <span class='cql' title='Any piece at all'>&#x25d1;</span> 4)
</code></div>

<p>
This matches positions in which the white pieces have power precisely 4
greater than the black pieces.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:powerdifference</span></span> [<span class='piece'>&#x2656;</span><span class='piece'>&#x265c;</span>] -5 10)
</code></div>

<p>
This matches positions in which white has between one fewer and two more
rooks than black.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:powerdifference</span></span> [<span class='piece'>&#x2656;</span><span class='piece'>&#x265c;</span><span class='piece'>&#x2657;</span><span class='piece'>&#x265d;</span><span class='piece'>&#x2658;</span><span class='piece'>&#x265e;</span>] &lt;=-2)
</code></div>

<p>
This matches positions in which black is up at least an exchange.
</p>

<div class='box'><pre><code><!--
-->(position
  <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:flipcolor">:flipcolor</span></a>
  <span style='white-space:nowrap;'><span class='keyword'>:powerdifference</span></span> [<span class='piece'>&#x2656;</span><span class='piece'>&#x265c;</span><span class='piece'>&#x2657;</span><span class='piece'>&#x265d;</span><span class='piece'>&#x2658;</span><span class='piece'>&#x265e;</span>] &lt;=-2)<!--
--></code></pre></div>

<p>
This matches positions in which one side is up at least an exchange.
</p>

<div id="eithercolor:example">
<div class='box'><pre><code><!--
-->(match
  <span style='white-space:nowrap;'><a href="CQL-Match-List.html#match:result">:result</span></a> 1-0
  (position
    <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:sequence">:sequence</span></a> (
      (position
        <span style='white-space:nowrap;'><span class='keyword'>:powerdifference</span></span> <span class='cql' title='Any piece at all'>&#x25d1;</span> -2 +2
        <span style='white-space:nowrap;'><span class='keyword'>:powerdifference</span></span> <span class='piece'>&#x2655;</span> <span class='piece'>&#x265b;</span> 0)
      (position
        <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:repetitioncount">:repetitioncount</span></a> &gt;=12
        <span style='white-space:nowrap;'><span class='keyword'>:powerdifference</span></span> <span class='piece'>&#x2655;</span> <span class='piece'>&#x265b;</span> &lt;=&#x2212;9))))<!--
--></code></pre></div>
</div>

<p>
This example shows a way how to search for queen sacrifices using
<code>:powerdifference</code>. One side sacrifices a queen, and remains at
least 9 pawns down in material for at least 12 moves, and finally wins.
</p>

<p>
See also: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:powerdifference_">:powerdifference*</span></a>.
</p>

<h3 id="position:ray">:ray</h3>

<p>
A ray specifier is a list of piece designators. A ray is a contiguous set of
squares on a straight line on the chessboard parallel to an axis, the a1-h1
diagonal, or the a8-h8 diagonal.
</p>

<p>
Let R by a ray with ordered set of squares in a contiguous line
<span style='white-space:nowrap;'>S<sub>1</sub>,</span> <span style='white-space:nowrap;'>S<sub>2</sub>,</span> <span style='white-space:nowrap;'>...,</span>
<span style='white-space:nowrap;'>S<sub>n</sub>.</span> Suppose a given ray specifier
<span style='white-space:nowrap;'>(G<sub>1</sub>,</span> <span style='white-space:nowrap;'>G<sub>2</sub>,</span> <span style='white-space:nowrap;'>...,</span>
<span style='white-space:nowrap;'>G<sub>k</sub>)</span> where each G<sub>i</sub> is a piece designator.
The ray R is valid with respect to the ray specifier if <span style='white-space:nowrap;'>G<sub>1</sub></span>
matches the piece on <span style='white-space:nowrap;'>S<sub>1</sub>,</span> and if <span style='white-space:nowrap;'>G<sub>k</sub></span>
matches the piece on <span style='white-space:nowrap;'>S<sub>n</sub>,</span> and if the remaining
<span style='white-space:nowrap;'>G<sub>i</sub></span> can be paired to some subset of the squares in the
ray in an order-preserving way such that each <span style='white-space:nowrap;'>G<sub>i</sub></span>
matches the piece on its corresponding square and such that all unpaired
squares in the ray are empty.
</p>

<p>
The <span style='white-space:nowrap;'>:ray</span> keyword takes a ray specifier and an optional
<a href="CQL-Range-Specifiers.html">range specifier</a>. If the range specifier
is absent, it is taken to be <span style='white-space:nowrap;'><code>&gt;=1</code>.
Otherwise, <span style='white-space:nowrap;'>:ray</span> matches a position if
the number of rays in the position valid with respect to the ray specifier lies
within the range specifier.
</p>

<p>
Examples:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:ray</span></span> (<span class='piece'>&#x265a;</span> <span class='piece'>&#x2655;</span>))
</code></div>

<p>
Will match a position in which a white queen attacks the black king.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:ray</span></span> (<span class='piece'>&#x2655;</span>a? <span class='piece'>&#x265e;</span> <span class='piece'>&#x265a;</span>[?4-8]))
</code></div>

<p>
Will match a position in which a white queen on the a file pins a black knight
to the black king on the last four ranks.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:ray</span></span> (<span class='piece'>&#x2655;</span>a? <span class='piece'>&#x2655;</span>c? <span class='piece'>&#x2655;</span>e? <span class='piece'>&#x265a;</span>g?))
</code></div>

<p>
Will match a position in which either three white queens and the black king are
on the same rank, with exactly one empty square between them, and one of the
queens is on the a-file, or a position in which the three white queens and
black king form a diagonal with one empty squares between successive pieces,
and the queens on the a, c, and e files in either cases.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:ray</span></span> (<span class='piece'>&#x2655;</span> <span class='piece'>&#x265e;</span> <span class='piece'>&#x265a;</span>) 2 4)
</code></div>

<p>
Between two and for black knights are pinned to the black king.
</p>

<p>
See also: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:rayattack">:rayattack</span></a>.
</p>

<h3 id="position:rayattack">:rayattack</h3>

<p>
Has the same syntax as <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:ray">:ray</span></a>. It has the semantics of
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:ray">:ray</span></a>, except that only orthogonal rays that start on
a square containing a rook or queen are included, and only diagonal rays
starting on a square containing a bishop or queen are included.
</p>

<p>
Examples:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:rayattack</span></span> (<span class='cql' title='Any white piece'>&#x25cb;</span> <span class='cql' title='Any black piece'>&#x25cf;</span> <span class='piece'>&#x265a;</span>))
</code></div>

<p>
Will match a position in which a black piece is pinned to the black king.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:rayattack</span></span> (<span class='cql' title='Any white piece'>&#x25cb;</span>d5 <span class='cql' title='Any black piece'>&#x25cf;</span> [<span class='piece'>&#x265c;</span><span class='piece'>&#x265a;</span>][a-h1-4]) 3)
</code></div>

<p>
Will match positions in which there are three black pieces pinned by a white
piece on d5 against either a black rook or king in the first four ranks.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:stalemate">:stalemate</span></a> <span style='white-space:nowrap;'><span class='keyword'>:rayattack</span></span>
(<span class='cql' title='Any white piece'>&#x25cb;</span> <span class='cql' title='Any black piece'>&#x25cf;</span> <span class='piece'>&#x265a;</span>) 2 8 <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:flipcolor">:flipcolor</span></a>)
</code></div>

<p>
Finds multiple-pin stalemates.
</p>

<p>
See also: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:ray">:ray</span></a>.
</p>

<h3 id="position:raydiagonal">:raydiagonal</h3>

<p>
This keyword function exactly like <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:ray">:ray</span></a> but the given rays
are restricted to being diagonal. A diagonal ray is a ray that is not vertical
or horizontal.
</p>

<h3 id="position:rayhorizontal">:rayhorizontal</h3>

<p>
This keyword function exactly like <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:ray">:ray</span></a> but the given rays
are restricted to being horizontal. A horizontal ray is a ray that is horizontal.
</p>

<h3 id="position:rayorthogonal">:rayorthogonal</h3>

<p>
This keyword function exactly like <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:ray">:ray</span></a> but the given rays
are restricted to being orthogonal. A orthogonal ray is a ray that is not
diagonal.
</p>

<h3 id="position:rayvertical">:rayvertical</h3>

<p>
This keyword function exactly like <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:ray">:ray</span></a> but the given rays
are restricted to being vertical. A vertical ray is a ray that is vertical.
</p>

<!-- ############################################################################## -->
<h2 id="move">Move keywords</h2>
<!-- ############################################################################## -->

<p>
In a position, the next move is the move about to be played, if any. A move has
three characteristics: its origin square designator, its destination square
designator and its promotion designator. These refer respectivelyto the piece
and square from which the piece moves; to the piece and square to which it is
going to move (but before it actually moves there), and to the piece and square
to which it promotes, if any. In chess variants Drop Chess
and Bughouse Chess there is a fourth characteristic: the
piecedrop designator. It refers to the piecetype which will be dropped, if any.
</p>

<p>
For example, the destination designation of a white rook on a4 capturing a black
knight on d4 is <span style='white-space:nowrap;'><code><span class='piece'>&#x265e;</span>d4</code></span>, and its origin designation is
<span style='white-space:nowrap;'><code><span class='piece'>&#x2656;</span>a4</code></span>. The destination designation of a move to e4 that is not a
capture is <span style='white-space:nowrap;'><code>.e4</code></span>.
</p>

<table style="white-space:nowrap">
  <tr><td>&#x2022;</td><td><a href="#position:captureforced">:captureforced</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:enpassant">:enpassant</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:forced">:forced</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:halfmovenumber">:halfmovenumber</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:iscastling">:iscastling</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:ischeck">:ischeck</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:iscontactcheck">:iscontactcheck</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:isdoublecheck">:isdoublecheck</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:isillegal">:isillegal</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:isinvalid">:isinvalid</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:ismate">:ismate</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:isnull">:isnull</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:isstalemate">:isstalemate</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:movefrom">:movefrom</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:movenumber">:movenumber</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:moveto">:moveto</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:noenpassant">:noenpassant</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:promote">:promote</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:takeslastpiece">:takeslastpiece</a></td></tr>
</table>

<h3 id="position:captureforced">:captureforced&ensp;<img src="../images/ft-scidb-tiny.png" alt="" />&emsp;<span class='normal'>(Schlagen ist erzwungen)</span></h3>

<p>
Der nÃ¤chste Zug ist verpflichtet eine Figur zu schlagen. Dieses SchlÃ¼sselwort
hat nur in der Schachform Antichess eine Bedeutung und wird in
anderen Schachformen niemals erfÃ¼llt.
</p>

<p>
Dieses SchlÃ¼sselwort kann auch in negierter Form &ndash; mit einem vorangestellten
Ausrufungszeichen &ndash; verwendet werden. Beispiel:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'>!<span class='keyword'>:captureforced</span></span>)
</code></div>

<p>
Der nÃ¤chste Zug ist nicht verpflichtet eine Figur zu schlagen, dies
heiÃt das in dieser Stellung auch keine Figur geschlagen werden kann.
Dies gilt jedoch nur fÃ¼r die Schachform Antichess,
in allen anderen Schachformen wird diese Bedingung immer erfÃ¼llt.
</p>

<p>
Siehe auch: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:mustcapture">:mustcapture</span></a>.
</p>

<h3 id="position:forced">:forced&ensp;<img src="../images/ft-scidb-tiny.png" alt="" />&emsp;<span class='normal'>(Forciert)</span></h3>

<p>
Der nÃ¤chste Zug ist erzwungen, kein anderer Zug ist mÃ¶glich.
</p>

<p>
Dieses SchlÃ¼sselwort kann auch in negierter Form &ndash; mit einem vorangestellten
Ausrufungszeichen &ndash; verwendet werden. Beispiel:
</p>

<div class='verb'><code>(position <span style='white-space:nowrap;'>!<span class='keyword'>:forced</span></span>)
</code></div>

<p>
Der nÃ¤chste Zug ist nicht erzwungen, es gibt auch andere ZÃ¼ge (auch wenn sie nicht
gut sein sollten).
</p>

<h3 id="position:enpassant">:enpassant</h3>

<p>
The next move is an en-passant capture.
</p>

<p>
See also: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:noenpassant">:noenpassant</span></a>
</p>

<h3 id="position:halfmovenumber">:halfmovenumber&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
<span style='white-space:nowrap;'>:halfmovenumber</span> expects a <a href="CQL-Range-Specifiers.html">range specifier</a>
as argument, and is matching a position only if the actual half move number is
inside the given range. Inside of sub-variants this keyword has no effect and will
always fail.
</p>

<p>
Examples:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:halfmovenumber</span></span> 0)
</code></div>

<p>
This denotes the first position in the game (prior to first move). This is
identical to:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:initial">:initial</span></a>)
</code></div>

<p>
As an extension also <span style='white-space:nowrap;'><code>end</code></span>, or <span style='white-space:nowrap;'><span style='white-space:nowrap;'><code>end</code></span>&minus;N</span>
can be used as a range argument. Two examples:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:halfmovenumber</span></span> end)
</code></div>

<p>
This is matching the final position (after last move in game); see also
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:final">:final</span></a>.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:halfmovenumber</span></span> end-3)
</code></div>

<p>
Will match the third from last half move in the game, this means three
half move will follow.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:halfmovenumber</span></span> end-1 <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:moveto">:moveto</span></a> <span class='cql' title='Any piece at all'>&#x25d1;</span>)
</code></div>

<p>
Match all games where a piece will be captured in the last move of the game.
This is simpler and more efficient than this equivalent notation:
</p>

<div class='box'><pre><code><!--
-->(position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:sequence">:sequence</span></a> (
  (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:moveto">:moveto</span></a> <span class='cql' title='Any piece at all'>&#x25d1;</span>)
  (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:final">:final</span></a>))<!--
--></code></pre></div>

<div class='annotation'><img src='../images/annotation.png' style='float:left; margin:0 1em 0 0' alt='annotation' />
The use of <span style='white-space:nowrap;'>:halfmovenumber</span> may reduce the search time considerably.
</div>

<p>
See also: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:initial">:initial</span></a>, <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:final">:final</span></a>,
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:movenumber">:movenumber</span></a>.
</p>

<h3 id="position:iscastling">:iscastling&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
The next move is a castling move.
As an optional argument the piece designators <span class='piece'>&#x2654;</span>, <span class='piece'>&#x265a;</span>, <span class='piece'>&#x2655;</span>, and <span class='piece'>&#x265b;</span> will
specify the castling more exactly.
</p>

<p>
Examples:
</p>

<div class='verb'><code>
  <span style='white-space:nowrap;'><span class='keyword'>:iscastling</span></span> <span class='comment'>; side to move is castling</span>
</code></div>
<div class='verb'><code>
  <span style='white-space:nowrap;'><span class='keyword'>:iscastling</span></span> <span class='piece'>&#x2654;</span> <span class='comment'>; White is castling short</span>
</code></div>
<div class='verb'><code>
  <span style='white-space:nowrap;'><span class='keyword'>:iscastling</span></span> [<span class='piece'>&#x2654;</span><span class='piece'>&#x2655;</span>] <span class='comment'>; White is castling</span>
</code></div>
<div class='verb'><code>
  <span style='white-space:nowrap;'><span class='keyword'>:iscastling</span></span> [<span class='piece'>&#x2655;</span><span class='piece'>&#x265b;</span>] <span class='comment'>; side to move is castling long</span>
</code></div>

<p>
See also: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:castling">:castling</span></a>, <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:nocastling">:nocastling</span></a>.
</p>

<h3 id="position:ischeck">:ischeck&ensp;<img src="../images/ft-scidb-tiny.png" alt="" />&emsp;<span class='normal'>(Schachgebot?)</span></h3>

<p>
Filtert eine Position, wenn der nÃ¤chste Zug ein Schachgebot ist. Ist als Argument
eine <a href="CQL-Range-Specifiers.html">Bereichsangabe</a> vorhanden, dann wird
eine Position gefiltert, wenn der nÃ¤chste Zug ein Schachgebot ist, und die Anzahl
der Schachgebote, die die Seite am Zug dem Gegner bot, einschlieÃlich des
nÃ¤chsten Zugs, innerhalb dieser Bereichsangabe liegt. Die untere Schranke dieser
Bereichsangabe kann nicht kleiner als 1 sein.
</p>

<p><img src='../images/note.png' alt='note' /> 
<span style='white-space:nowrap;'>:ischeck</span> mit nachfolgender Bereichsangabe ist in erster Linie nÃ¼tzlich
in der Schachform Three-check Chess. Das nachfolgende Beispiel gilt
fÃ¼r diese Schachform.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:ischeck</span></span> 3)
</code></div>

<p>
Die Seite am Zug bietet nun zum dritten Mal in der Partie dem Gegner
Schach. Dies kann nur eine Endstellung sein (in Three-check Chess).
</p>

<div class='verb'><code>
(position
  <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:matchcount">:matchcount</span></a> 1
  <span style='white-space:nowrap;'><span class='keyword'>:ischeck</span></span>)
</code></div>

<p>
Das einzige Schachgebot in der Partie Ã¼berhaupt.
</p>

<p>
Dieses SchlÃ¼sselwort kann auch in negierter Form &ndash; mit einem vorangestellten
Ausrufungszeichen &ndash; verwendet werden. Beispiel:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'>!<span class='keyword'>:ischeck</span></span>)
</code></div>

<p>
Der nÃ¤chste Zug ist kein Schachgebot.
</p>

<p>
Siehe auch: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:checkcount">:checkcount</span></a>,
</p>

<h3 id="position:iscontactcheck">:iscontactcheck&ensp;<img src="../images/ft-scidb-tiny.png" alt="" />&emsp;<span class='normal'>(Kontaktschachgebot?)</span></h3>

<p>
Der nÃ¤chste Zug ist ein Kontaktschachgebot.
</p>

<p>
Dieses SchlÃ¼sselwort kann auch in negierter Form &ndash; mit einem vorangestellten
Ausrufungszeichen &ndash; verwendet werden. Beispiel:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'>!<span class='keyword'>:iscontactcheck</span></span>)
</code></div>

<p>
Der nÃ¤chste Zug ist kein Kontaktschachgebot (aber trotzdem mÃ¶glicherweise
ein Schachgebot).
</p>

<p>
Siehe auch: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:contactcheck">:contactcheck</span></a>,
</p>

<h3 id="position:isdoublecheck">:isdoublecheck&ensp;<img src="../images/ft-scidb-tiny.png" alt="" />&emsp;<span class='normal'>(Doppelschachgebot?)</span></h3>

<p>
Der nÃ¤chste Zug ist ein Doppelschachgebot.
</p>

<p>
Dieses SchlÃ¼sselwort kann auch in negierter Form &ndash; mit einem vorangestellten
Ausrufungszeichen &ndash; verwendet werden. Beispiel:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'>!<span class='keyword'>:isdoublecheck</span></span>)
</code></div>

<p>
Der nÃ¤chste Zug ist kein Doppelschachgebot (aber trotzdem mÃ¶glicherweise
ein Schachgebot).
</p>

<p>
Siehe auch: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:doublecheck">:doublecheck</span></a>,
</p>

<h3 id="position:isillegal">:isillegal&ensp;<img src="../images/ft-scidb-tiny.png" alt="" />&emsp;<span class='normal'>(Regelwidrig?)</span></h3>

<p>
Der nÃ¤chste Zug ist ein regelwidriger Zug, beispielsweise eine Rochade, obwohl der
KÃ¶nig im Schach steht.
</p>

<p>
Dieses SchlÃ¼sselwort kann auch in negierter Form &ndash; mit einem vorangestellten
Ausrufungszeichen &ndash; verwendet werden. Beispiel:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'>!<span class='keyword'>:isillegal</span></span>)
</code></div>

<p>
Der nÃ¤chste ZUg ist kein regelwidriger Zug.
</p>

<h3 id="position:isinvalid">:isinvalid&ensp;<img src="../images/ft-scidb-tiny.png" alt="" />&emsp;<span class='normal'>(Unerlaubt?)</span></h3>

<p>
Der nÃ¤chste Zug ist ein unerlaubter Zug, beispielsweise ein LÃ¤uferzug, der auf einem
schwarzen Feld beginnt, aber auf einem weiÃen Feld endet (dies unterstÃ¼tzt den
Kinderschachmodus).
</p>

<p>
Dieses SchlÃ¼sselwort kann auch in negierter Form &ndash; mit einem vorangestellten
Ausrufungszeichen &ndash; verwendet werden. Beispiel:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'>!<span class='keyword'>:isinvalid</span></span>)
</code></div>

<p>
Der nÃ¤chste ZUg ist kein unerlaubter Zug.
</p>

<h3 id="position:ismate">:ismate&ensp;<img src="../images/ft-scidb-tiny.png" alt="" />&emsp;<span class='normal'>(Mattgebot?)</span></h3>

<p>
Der nÃ¤chste Zug ist ein Mattgebot.
</p>

<p>
Dieses SchlÃ¼sselwort kann auch in negierter Form &ndash; mit einem vorangestellten
Ausrufungszeichen &ndash; verwendet werden. Beispiel:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'>!<span class='keyword'>:ismate</span></span>)
</code></div>

<p>
Der nÃ¤chste Zug ist kein Mattgebot.
</p>

<p>
Siehe auch: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:mate">:mate</span></a>,
</p>

<h3 id="position:isnull">:isnull&ensp;<img src="../images/ft-scidb-tiny.png" alt="" />&emsp;<span class='normal'>(Nullzug?)</span></h3>

<p>
Der nÃ¤chste Zug ist ein Nullzug.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:isnull</span></span>)
</code></div>

<p>
Suche nach Partien die einen Nullzug enthalten.
</p>

<p>
Dieses SchlÃ¼sselwort kann auch in negierter Form &ndash; mit einem vorangestellten
Ausrufungszeichen &ndash; verwendet werden. Beispiel:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'>!<span class='keyword'>:isnull</span></span>)
</code></div>

<p>
Filtere alle Positionen, in denen kein Nullzug erfolgt.
</p>

<h3 id="position:isstalemate">:isstalemate&emsp;<span class='normal'>(Pattgebot?)</span></h3>

<p>
Der nÃ¤chste Zug ist ein Pattgebot.
</p>

<p>
Dieses SchlÃ¼sselwort kann auch in negierter Form &ndash; mit einem vorangestellten
Ausrufungszeichen &ndash; verwendet werden. Beispiel:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'>!<span class='keyword'>:isstalemate</span></span>)
</code></div>

<p>
Der nÃ¤chste Zug ist kein Pattgebot.
</p>

<p>
Siehe auch: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:stalemate">:stalemate</span></a>,
</p>

<h3 id="position:movefrom">:movefrom</h3>

<p>
Takes a single parameter, a piece designator. It matches a move whose from
designator matches that piece designator.
</p>

<p>
Examples:
</p>

<div class='verb'><code>
<span style='white-space:nowrap;'><span class='keyword'>:movefrom</span></span> <span class='piece'>&#x2656;</span>a3
</code></div>

<p>
Will match a position in which the next move is of a white rook on a3.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:movefrom</span></span> <span class='cql' title='Any piece at all'>&#x25d1;</span>?8)
</code></div>

<p>
Will match a position in which the next move is of some piece on the 8th rank.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:movefrom</span></span> <span class='piece'>&#x2655;</span>[+] <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:moveto">:moveto</span></a> .?8)
</code></div>

<p>
A white queen will be dropped on Black's back rank.
(Drop Chess, Bughouse Chess).
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:movefrom</span></span> ???)
</code></div>

<p>
This expression is useful in Drop Chess, and Bughouse Chess:
in this position no piece (from backhand) will be dropped.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:movefrom</span></span> .)
</code></div>

<p>
This can never match, even a piece drop move
(Drop Chess, Bughouse Chess)
will not match.
</p>

<p>
See also: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:line">:line</span></a>, <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:moveto">:moveto</span></a>,
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:null">:null</span></a>, <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:promote">:promote</span></a>.
</p>

<h3 id="position:movenumber">:movenumber</h3>

<p>
<span style='white-space:nowrap;'>:movenumber</span> takes a
<a href="CQL-Range-Specifiers.html">range specifier</a> as parameter and
matches positions only if the current move number is within the specified
range. The move number computation assumes white moves first.
</p>

<p>
Examples:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:movenumber</span></span> 10 20 <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:check">:check</span></a>)
</code></div>

<p>
Will match a position in which there is a check between moves 10 and 20.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:movenumber</span></span> 35 <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:mate">:mate</span></a>)
</code></div>

<p>
Will match a position in which move 35 is mate.
</p>

<p>
As an extension (to the CQL standard) also <span style='white-space:nowrap;'><code>end</code></span>, or
<span style='white-space:nowrap;'><span style='white-space:nowrap;'><code>end</code></span>&minus;N</span> can be used as an argument for
the range.
But the behaviour is undefined when the search inside sub-variations is
switched on (&#x21d2; <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:variations">:variations</span></a>), this means that this
extension shouldn't be used in such cases.
Two examples:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:movenumber</span></span> end)
</code></div>

<p>
This denotes the final position (after last move in game); see also
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:final">:final</span></a>.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:movenumber</span></span> end-3)
</code></div>

<p>
This denotes the third to last move in the game (do not confuse this
with half moves; see siehe <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:halfmovenumber">:halfmovenumber</span></a>).
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:movenumber</span></span> end-4 end-3)
</code></div>

<p>
This denotes the range from fourth to last until third to last move
in the game.
</p>

<p>
See also: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:halfmovenumber">:halfmovenumber</span></a>, <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:initial">:initial</span></a>,
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:final">:final</span></a>.
</p>

<h3 id="position:moveto">:moveto</h3>

<p>
Takes a single parameter, a piece designator. It matches a move whose
destination designator matches its parameter.
</p>

<p>
Examples:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:moveto</span></span> <span class='cql' title='Any piece at all'>&#x25d1;</span>)
</code></div>

<p>
Is matching a position where next move is a capture move.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:moveto</span></span> .)
</code></div>

<p>
Is matching a position where next move is not a capture move.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:moveto</span></span> <span class='cql' title='Any piece at all'>&#x25d1;</span>~)
</code></div>

<p>
Next move is capturing a promotion piece.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:moveto</span></span> <span class='cql' title='Any piece at all'>&#x25d1;</span>~~)
</code></div>

<p>
Next move is capturing a piece which is not the result of a pawn promotion.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:moveto</span></span> <span class='piece'>&#x2656;</span>[b1-8])
</code></div>

<p>
Will match a position in which the next move is to capture a white rook on
the b file. Note that this is quite different from the natural
<a href="http://de.wikipedia.org/wiki/Portable_Game_Notation" target="blank_">PGN&nbsp;<span class="awesome">&#xf08e;</span></a>
interpration of its being a move of a white rook to the b file. That
would be done via:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:movefrom">:movefrom</span></a> <span class='piece'>&#x2656;</span> <span style='white-space:nowrap;'><span class='keyword'>:moveto</span></span> ?b?)
</code></div>

<p>
Will match a move of the white rook to the b file.
This excludes a rook from backhand (Drop Chess,
and Bughouse Chess). If a piece from backhand should
be included, we need an extended definition:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:movefrom">:movefrom</span></a> <span class='piece'>&#x2656;</span>[*] <span style='white-space:nowrap;'><span class='keyword'>:moveto</span></span> ?b?)
</code></div>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:moveto</span></span> <span class='piece'>&#x2656;</span>[b1-8])
</code></div>

<p>
In next case we will handle an en passant capture:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:moveto</span></span> .e6 <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:enpassant">:enpassant</span></a>)
</code></div>

<p>
A pawn on e5 will be captured en passant.
</p>

<p>
See also: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:line">:line</span></a>, <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:movefrom">:movefrom</span></a>,
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:null">:null</span></a>, <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:promote">:promote</span></a>.
</p>

<h3 id="position:noenpassant">:noenpassant</h3>

<p>
The next move is not an en-passant capture.
</p>

<p>
See also: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:enpassant">:enpassant</span></a>.
</p>

<h3 id="position:promote">:promote</h3>

<p>
Takes a single parameter, a piece designator. It matches a move if that move
is a promotion whose promotion designator matches its parameter.
</p>

<p>
Examples:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:promote</span></span> [<span class='piece'>&#x2656;</span><span class='piece'>&#x2657;</span><span class='piece'>&#x2658;</span>])
</code></div>

<p>
Will match a position whose next move is a white underpromotion.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:promote</span></span> [<span class='piece'>&#x2657;</span><span class='piece'>&#x2658;</span>]a8)
</code></div>

<p>
Will match a position whose next move is a white promotion to bishop or knight.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:promote</span></span> <span class='piece'>&#x2656;</span>e8
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:movefrom">:movefrom</span></a> <span class='piece'>&#x2659;</span>f7 <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:moveto">:moveto</span></a> <span class='piece'>&#x265b;</span>)
</code></div>

<p>
Will match a position in which the next move is of a pawn on f7 capturing a black
queen on e8 and promoting to a rook.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:promote</span></span> [])
</code></div>

<p>
Will match a position in which the next move is not a promotion (because the
piecetype designator is empty).
</p>

<p>
See also: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:line">:line</span></a>, <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:movefrom">:movefrom</span></a>,
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:moveto">:moveto</span></a>, <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:null">:null</span></a>.
</p>

<h3 id="position:takeslastpiece">:takeslastpiece&ensp;<img src="../images/ft-scidb-tiny.png" alt="" />&emsp;<span class='normal'>(SchlÃ¤gt die letzte Figur)</span></h3>

<p>
Dieses SchlÃ¼sselwort hat nur in der Schachform Antichess eine Bedeutung,
und kann in anderen Schachformen niemals erfÃ¼llt werden. Es wird erfÃ¼llt, wenn im nÃ¤chsten
Zug die letzte gegnerische Figur geschlagen wird.
</p>

<p>
Dieses SchlÃ¼sselwort kann auch in negierter Form &ndash; mit einem vorangestellten
Ausrufungszeichen &ndash; verwendet werden. Beispiel:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'>!<span class='keyword'>:takeslastpiece</span></span>)
</code></div>

<p>
In der Schachformen Antichess wird es erfÃ¼llt, wenn im nÃ¤chsten
Zug nicht die letzte gegnerische Figur geschlagen wird. In anderen Schachformen
wird diese Bedingung immer erfÃ¼llt.
</p>

<p>
Siehe auch: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:losing">:losing</span></a>,
</p>

<!-- ############################################################################## -->
<h2 id="sequence">Sequence keywords</h2>
<!-- ############################################################################## -->

<table style="white-space:nowrap">
  <tr><td>&#x2022;</td><td><a href="#position:gappedsequence">:gappedsequence</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:line">:line</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:line_">:line*</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:match">:match</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:matchconsecutive">:matchconsecutive</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:sequence">:sequence</a></td></tr>
</table>

<h3 id="position:gappedsequence">:gappedsequence</h3>

<p>
Takes one argument, a list of position lists. A position list A is said to be
a refinement of a position list B if A may be formed from B by inserting zero or
more position lists of the form <span style='white-space:nowrap;'><code>(position)</code></span> into the top level of B.
For example:
</p>

<div class='verb'><code>
((position <span class='piece'>&#x2658;</span>a4) (position) (position <span class='piece'>&#x2656;</span>b2))
</code></div>

<p>
refines
</p>

<div class='verb'><code>
((position <span class='piece'>&#x2658;</span>a4) (position <span class='piece'>&#x2656;</span>b2))
</code></div>

<p>
because it was formed by inserting a single position list into the latter list.
</p>

<p>
A <span style='white-space:nowrap;'>:gappedsequence</span> with argument B will match a position if and only if
there is a refinement A of B such that a <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:sequence">:sequence</span></a> with
argument A would match that position. That is, <span style='white-space:nowrap;'>:gappedsequence</span> is
like <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:sequence">:sequence</span></a> except that the sequence of matching positions
may include intervening positions from the game.
</p>

<p>
Examples:
</p>

<div class='box'><pre><code><!--
-->(position
  <span style='white-space:nowrap;'><span class='keyword'>:gappedsequence</span></span> (
    (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:movefrom">:movefrom</span></a> <span class='piece'>&#x2656;</span>a3)
    (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:movefrom">:movefrom</span></a> <span class='piece'>&#x2656;</span>b4)))<!--
--></code></pre></div>

<p>
This will match any position for which the positions that occur successively
in the game starting with that position comprise zero or more positions,
followed by a position from which a white rook on a3 moves, followed by zero
or more positions, followed by a position from which a white rook on b4 moves.
</p>

<p>
Standard CQL has the following limitation:
The total number of <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:sequence">:sequence</span></a> and <span style='white-space:nowrap;'>:gappedsequence</span>
position lists that can occur at the top level of a position list cannot exceed
one. To get the effect of either a <span style='white-space:nowrap;'>:gappedequence</span> and
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:sequence">:sequence</span></a> keywords in one position list, use <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:and">:and</span></a>.
But CQL-S does not have any limitations with the use of <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:sequence">:sequence</span></a>
and <span style='white-space:nowrap;'>:gappedsequence</span>.
</p>

<h3 id="position:line">:line&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
The argument is a string which contains a valid line. The long algebraic
notation has to be used. It is allowed to use piece and square designators.
Note that a pawn move will be assumed if the piece of the from square is
not specified. Furthermore check and mate signs can be used. Moreover
a pawn move may be designated as an en-passant move. Optional move numbers
will be considered when searching, the move numbers have to be strictly
ascending. Examples:
</p>

<table class="stripes" style="white-space: nowrap;">
  <tr valign="top" class="stripes">
    <td class="left">e2-e4</td>
    <td class="right">White pawn moves from e2 to e4.</td>
  </tr>
  <tr valign="top">
    <td class="left">1.e2-e4</td>
    <td class="right">In first move of the game a white pawn moves from e2 to e4.</td>
  </tr>
  <tr valign="top" class="stripes">
    <td class="left">1...e7-e5</td>
    <td class="right">In first move of the game a black pawn moves from e7 to e5.</td>
  </tr>
  <tr valign="top">
    <td class="left">e2-Ne4</td>
    <td class="right">This is an invalid move and will be rejected as an error.</td>
  </tr>
  <tr valign="top" class="stripes">
    <td class="left">d5xe6 e.p.</td>
    <td class="right">White pawn on d5 is capturing the pawn on e5 en-passant.</td>
  </tr>
  <tr valign="top">
    <td class="left">d5xe6</td>
    <td class="right">White pawn on d5 is capturing a pawn on e6<br/>
      (en-passant is precluded in this case).</td>
  </tr>
  <tr valign="top" class="stripes">
    <td class="left"><span class='piece'>&#x2658;</span>b1-[ac]3</td>
    <td class="right">White knight moves from b1 to a3 or to c3.</td>
  </tr>
  <tr valign="top">
    <td class="left"><span class='piece'>&#x2657;</span>[bg]7x<span class='cql' title='Black minor piece'>&#x25bc;</span>?8</td>
    <td class="right">White bishop on b7 oder g7 is capturing a black<br/>
      major piece on eighth rank.</td>
  </tr>
  <tr valign="top" class="stripes">
    <td class="left"><span class='cql' title='White major piece'>&#x25b3;</span>?[1-7]-?8+</td>
    <td class="right">White major piece moves to blacks back rank and
      gives check to black king.</td>
  </tr>
  <tr valign="top">
    <td class="left"><span class='piece'>&#x2658;</span>??-f7++</td>
    <td class="right">White knight moves to square f7 and gives double
      check to black king.</td>
  </tr>
  <tr valign="top" class="stripes">
    <td class="left"><span class='piece'>&#x2658;</span>??-f7#</td>
    <td class="right">White knight moves to square f7 and checkmates.</td>
  </tr>
</table>

<p>
This keywords serves for a simpler notation of move sequences. Therefore the
position list
</p>

<div class='box'><pre><code><!--
-->(position <span style='white-space:nowrap;'><span class='keyword'>:line</span></span> "e2-e4 e7-e6 d2-d4 d7-d5")<!--
--></code></pre></div>

<p>
is identical to the following sequenc:
</p>

<div class='box'><pre><code><!--
-->(position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:sequence">:sequence</span></a> (
  (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:movefrom">:movefrom</span></a> Pe2 <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:moveto">:moveto</span></a> e4)
  (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:movefrom">:movefrom</span></a> pe7 <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:moveto">:moveto</span></a> e6)
  (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:movefrom">:movefrom</span></a> Pd2 <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:moveto">:moveto</span></a> d4)
  (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:movefrom">:movefrom</span></a> pd7 <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:moveto">:moveto</span></a> d5)))<!--
--></code></pre></div>

<p>
The special letter <code>*</code> at the end of the string is denoting
a transposition invariant search, and the search will start automatically
with the first move in the current start position. Moreover possible en passant
rights will be ignored. Example:
</p>

<div class='box'><pre><code><!--
-->(position <span style='white-space:nowrap;'><span class='keyword'>:line</span></span> "e2-e4 e7-e6 d2-d4 d7-d5 *")<!--
--></code></pre></div>

<p>
Match all positions starting with French, inclusive move transpositions
like "d2-d4 d7-d5 e2-e4 e7-e6". In games with a normal start position
(position 518 in Chess960) this equivalent to the following query:
</p>

<div class='box'><pre><code><!--
-->(position
  <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:fen">:fen</span></a> "rnbqkbnr/pppp1ppp/4p3/8/4P3/8/PPPP1PPP/RNBQKBNR w KQkq - 0 2")<!--
--></code></pre></div>

<p>
If the exact opening line "e2-e4 e7-e6 d2-d4 d7-d5" should be found, the
following query has to be used:
</p>

<div class='box'><pre><code><!--
-->(position <span style='white-space:nowrap;'><span class='keyword'>:line</span></span> "1.e2-e4 e7-e6 2.d2-d4 d7-d5")<!--
--></code></pre></div>

<p>
See also: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:fen">:fen</span></a>, <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:sequence">:sequence</span></a>.
</p>

<h3 id="position:line_">:line*&ensp;<img src="../images/ft-scidb-tiny.png" alt="" />&emsp;<span class='normal'>(Transpositionsinvariante Zugfolge)</span></h3>

<p>
Diese Version von <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:line">:line</span></a> prÃ¼ft Zugsequenzen
transpositionsinvariant, und die Suche beginnt deshalb immer mit dem ersten
Zug in der vorliegenden Grundstellung. Es kÃ¶nnen optional Zugnummern verwendet
werden, sie sind jedoch hier nicht erforderlich.  Eine transpositionsinvariante
Suche ist jedoch nur mÃ¶glich wenn alle ZÃ¼ge eindeutig bestimmt sind (eindeutiges
Herkunftsfeld, eindeutiges Zielfeld, eindeutige Figuren, eindeutige
Bauernumwandlung). Dies ist erforderlich damit beispielsweise auch
Schach-960-Positionen korrekt geprÃ¼ft werden. Weiterhin wird bei der
transpositionsinvarianten Suche ein mÃ¶gliches en-passant-Recht ignoriert.
Transformierende SchlÃ¼sselwÃ¶rter (<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:flip">:flip</span></a>,
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:flipcolor">:flipcolor</span></a>, &hellip;) sind in Verbindung mit
Transpositionsinvarianz nicht erlaubt.
</p>

<p>
Auch sind bei einer transpositionsinvarianten Suche die Angaben von Schach,
Doppelschach und Kontaktschach nicht erlaubt, auÃer im letzten Halbzug.
Solche Angaben im letzten Zug schrÃ¤nken im allgemeinen die mÃ¶glichen
Transpositionen ein.
</p>

<p>
Potentielle Zugfolgen wie bei <span style='white-space:nowrap;'>:line</span> sind hier nicht erlaubt.
</p>

<p>
Beispiele:
</p>

<div class='box'>
  <dl>
    <dt><span style='white-space:nowrap;'><code>(e2-e4 d7-d5)</code></span></dt>
    <dd>
      Dies ist eine fehlerhafter Ausdruck, die Figuren sind nicht eindeutig
      bestimmt.
    </dd>
    <dt style="margin-top:10px"><span style='white-space:nowrap;'><code>(<span class='piece'>&#x2659;</span>e2-e4 <span class='piece'>&#x2659;</span>d7-d5)</code></span></dt>
    <dd>
      Dies ist eine korrekter Ausdruck (die Figurenfarbe wird durch die
      Halbzugposition eindeutig bestimmt).
    </dd>
    <dt style="margin-top:10px"><span style='white-space:nowrap;'><code>(<span class='piece'>&#x2659;</span>e2-e4 <span class='piece'>&#x265f;</span>d7-d5)</code></span></dt>
    <dd>
      Ebenfalls ein korrekter Ausdruck.
    </dd>
    <dt style="margin-top:10px"><span style='white-space:nowrap;'><code>(<span class='piece'>&#x2659;</span>e2-e4 <span class='piece'>&#x265f;</span>d7-d5 <span class='piece'>&#x2659;</span>e4xd5)</code></span></dt>
    <dd>
      Inkorrekt, denn die geschlagene Figur ist nicht eindeutig.
    </dd>
    <dt style="margin-top:10px"><span style='white-space:nowrap;'><code>(<span class='piece'>&#x2659;</span>e2-e4 <span class='piece'>&#x265f;</span>d7-d5 <span class='piece'>&#x2659;</span>e4x<span class='piece'>&#x2659;</span>d5)</code></span></dt>
    <dd>
      Korrekt, alles ist eindeutig bestimmt.
    </dd>
    <dt style="margin-top:10px"><span style='white-space:nowrap;'><code>(<span class='piece'>&#x2659;</span>e2-e?)</code></span></dt>
    <dd>
      Inkorrekt, denn das Zielfeld ist nicht eindeutig.
    </dd>
    <dt style="margin-top:10px"><span style='white-space:nowrap;'><code>(<span class='piece'>&#x2659;</span>e2-e4 <span class='piece'>&#x2659;</span>f7-f6 <span class='piece'>&#x2655;</span>d1-h5+ <span class='piece'>&#x2659;</span>g7-g6)</code></span></dt>
    <dd>
      Inkorrekt, denn ein Schachgebot darf hier nicht notiert werden.
    </dd>
    <dt style="margin-top:10px"><span style='white-space:nowrap;'><code>(<span class='piece'>&#x2659;</span>e2-e4 <span class='piece'>&#x2659;</span>f7-f6 <span class='piece'>&#x2655;</span>d1-h5+)</code></span></dt>
    <dd>
      Korrekt, ein Schachgebot im letzten Halbzug ist zulÃ¤ssig,
    </dd>
  </dl>
</div>

<p>
Weitere Beispiele:
</p>

<div class='box'><pre><code><!--
-->(position <span style='white-space:nowrap;'><span class='keyword'>:line*</span></span> (1.<span class='piece'>&#x2659;</span>e2-e4 <span class='piece'>&#x2659;</span>e7-e6 2.<span class='piece'>&#x2659;</span>d2-d4 <span class='piece'>&#x2659;</span>d7-d5))<!--
--></code></pre></div>

<p>
Filtere alle Stellungen die mit FranzÃ¶sisch beginnen, inklusive Zugumstellungen
wie 1.d4 d5 2.e4 e6. Dies ist Ã¤quivalent zur folgenden
Abfrage:
</p>

<div class='box'><pre><code><!--
-->(position
  <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:fen">:fen</span></a> "rnbqkbnr/pppp1ppp/4p3/8/4P3/8/PPPP1PPP/RNBQKBNR w KQkq - 0 2")<!--
--></code></pre></div>

<p>
Wird die exakte ErÃ¶ffnungszugfolge 1.e4 e6 2.d4 d5 gesucht,
so geschieht dies mit:
</p>

<div class='box'><pre><code><!--
-->(position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:line">:line</span></a> (1.<span class='piece'>&#x2659;</span>e2-e4 <span class='piece'>&#x2659;</span>e7-e6 2.<span class='piece'>&#x2659;</span>d2-d4 <span class='piece'>&#x2659;</span>d7-d5))<!--
--></code></pre></div>

<p>
Siehe auch:
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:fen">:fen</span></a>,
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:line">:line</span></a>,
</p>

<h3 id="position:match">:match&ensp;<img src="../images/ft-scidb-tiny.png" alt="" />&emsp;<span class='normal'>(Suchfolge)</span></h3>

<p>
Dies entspricht genau dem Verhalten der Suchliste <span style='white-space:nowrap;'><code>(match</code></span>
<span style='white-space:nowrap;'><code>...)</code></span>, nur daÃ hier ausnahmslos Positionslisten als Argumente
erwartet werden. Somit wird dieses SchlÃ¼sselwort normalerweise nicht
benÃ¶tigt, es kann jedoch von Nutzen sein, wenn es als Argument fÃ¼r eines der
logischen SchlÃ¼sselwÃ¶rter dient. Ein formales Beispiel:
</p>

<div class='box'><pre><code><!--
-->(match
  (position
    <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:and">:and</span></a> (
      (position ...)
      (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:match">:match</span></a> (
        (position ...)
        (position ...)
        ...
        (position ...))))))<!--
--></code></pre></div>

<h3 id="position:matchconsecutive">:matchconsecutive&ensp;<img src="../images/ft-scidb-tiny.png" alt="" />&emsp;<span class='normal'>(Sukzessive Suchfolge)</span></h3>

<p>
Diese Variante der Suchfolge filtert genau dann eine Partie, wenn alle Positionen
dieser Suchfolge nacheinander aufgefunden werden, jedoch unabhÃ¤ngig von der Reihenfolge.
</p>

<p>
Beispiel:
</p>

<div class='box'><pre><code><!--
-->(match
  (position
    <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:flipcolor">:flipcolor</span></a>
    <span style='white-space:nowrap;'><span class='keyword'>:matchconsecutive</span></span> (
      (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:promote">:promote</span></a> <span class='piece'>&#x2657;</span>)
      (position)
      (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:promote">:promote</span></a> <span class='piece'>&#x2658;</span>))))<!--
--></code></pre></div>

<p>
Filtert alle Partien, in denen nacheinander eine der Parteien eine
Bauernumwandlung in zwei verschiedene Leichtfiguren ausfÃ¼hrt.
</p>

<h3 id="position:sequence">:sequence</h3>

<p>
Takes a single argument that is a list of position lists. It will match a given
position if and only successive occurring positions, beginning with the
current position, match each corresponding element in its argument.
</p>

<p>
Example:
</p>

<div class='box'><pre><code><!--
-->(position
  <span class='piece'>&#x2656;</span>e8
  <span style='white-space:nowrap;'><span class='keyword'>:sequence</span></span> (
    (position <span class='piece'>&#x2655;</span>f3 .g2)
    (position .f3 <span class='piece'>&#x2655;</span>g2)))<!--
--></code></pre></div>

<p>
This position list will match exactly those positions with a white rook on e8
such that:
</p>

<ol>
  <li>In that position, white has a queen on f3 and g2 is empty, and</li>
  <li>After the next move, f3 is empty and there is a white queen on g2.</li>
</ol>

<p>
In consequence, this position list is identical in effect to
</p>

<div class='verb'><code>
(position <span class='piece'>&#x2656;</span>e8 <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:movefrom">:movefrom</span></a> <span class='piece'>&#x2655;</span>f3 <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:moveto">:moveto</span></a> .g2)
</code></div>

<p>
Furthermore this is identical to:
</p>

<div class='verb'><code>
(position <span class='piece'>&#x2656;</span>e8 <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:line">:line</span></a> "<span class='piece'>&#x2655;</span>f3-g2")
</code></div>

<p>
The following more typical usage of <span style='white-space:nowrap;'>:sequence</span> will search for all
queen staircase checking maneuvers by either side:
</p>

<div class='box'><pre><code><!--
-->(position
  <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:shift">:shift</span></a> <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:flip">:flip</span></a> <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:flipcolor">:flipcolor</span></a>
  <span style='white-space:nowrap;'><span class='keyword'>:sequence</span></span> (
    (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:movefrom">:movefrom</span></a> <span class='piece'>&#x2655;</span>a2)
    (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:check">:check</span></a>)
    (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:movefrom">:movefrom</span></a> <span class='piece'>&#x2655;</span>b2)
    (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:check">:check</span></a>)
    (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:movefrom">:movefrom</span></a> <span class='piece'>&#x2655;</span>b3)
    (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:check">:check</span></a>)
    (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:movefrom">:movefrom</span></a> <span class='piece'>&#x2655;</span>c3)
    (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:check">:check</span></a>)
    (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:movefrom">:movefrom</span></a> <span class='piece'>&#x2655;</span>c4)
    (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:check">:check</span></a>)))<!--
--></code></pre></div>

<p>
This position list will match any position with a white queen on a2 for which
there are successively moves by queens on the indicated squares giving check;
the <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:shift">:shift</span></a>, <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:flip">:flip</span></a>, and
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:flipcolor">:flipcolor</span></a> search for this variation reflected or
rotated anywhere on the board. But this can be expressed much simpler:
</p>

<div class='box'><pre><code><!--
-->(position
  <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:shift">:shift</span></a> <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:flip">:flip</span></a> <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:flipcolor">:flipcolor</span></a>
  <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:line">:line</span></a> "<span class='piece'>&#x2655;</span>a2-b2+ <span class='piece'>&#x2655;</span>b2-b3+ <span class='piece'>&#x2655;</span>b3-c3+ <span class='piece'>&#x2655;</span>c3-c4+")<!--
--></code></pre></div>

<p>
See also: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:line">:line</span></a>.
</p>

<!-- ############################################################################## -->
<h2 id="game">Game related keywords</h2>
<!-- ############################################################################## -->

<p>
Several keywords relate to the game parameters and are not affected by the
contents of the position; they are included as position list keywords instead
of match list keywords so the <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:flipcolor">:flipcolor</span></a> can be used with
them. these are:
</p>

<table style="white-space:nowrap">
  <tr><td>&#x2022;</td><td><a href="#position:elo">:elo</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:whiteelo">:whiteelo</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:blackelo">:blackelo</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:ischess960">:ischess960</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:isshufflechess">:isshufflechess</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:result">:result</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:startposition">:startposition</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:variant">:variant</a></td></tr>
</table>

<h3 id="position:blackelo">:blackelo</h3>

<p>
This keyword takes a <a href="CQL-Range-Specifiers.html">range specifier</a>;
the ELO of the black player must lie within its range. One special case:
</p>

<div class='verb'><code>
<span style='white-space:nowrap;'><span class='keyword'>:blackelo</span></span> 0
</code></div>

<p>
In this case all games will match whose black player does not have an ELO rating.
</p>

<p>
See also: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:whiteelo">:whiteelo</span></a>, <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:blackrating">:blackrating</span></a>,
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:whiterating">:whiterating</span></a>.
</p>

<h3 id="position:elo">:elo</h3>

<p>
This keyword is supported only due to compatibility reasons with the CQL standard.
It is recommended to use instead the identically named keyword
<span style='white-space:nowrap;'><a href="CQL-Match-List.html#match:elo">:elo</span></span> : <span style='white-space:nowrap;'>match</span></a> in the match list. For a description also see
<span style='white-space:nowrap;'><a href="CQL-Match-List.html#match:elo">:elo</span></span> : <span style='white-space:nowrap;'>match</span></a>.
</p>

<h3 id="match:ischess960">:ischess960&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
Matches all games starting with a Chess960 Position. This includes the standard start
position 518.
</p>

<p>
See also: <span style='white-space:nowrap;'><a href="CQL-Match-List.html#match:ischess960">:ischess960</span></span> : <span style='white-space:nowrap;'>match</span></a>, <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:isshufflechess">:isshufflechess</span></a>.
</p>

<h3 id="match:isshufflechess">:isshufflechess&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
Matches all games starting with a Shuffle Chess Position. This includes all Chess960
positions.
</p>

<p>
See also: <span style='white-space:nowrap;'><a href="CQL-Match-List.html#match:isshufflechess">:isshufflechess</span></span> : <span style='white-space:nowrap;'>match</span></a>, <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:ischess960">:ischess960</span></a>.
</p>

<h3 id="position:result">:result</h3>

<p>
This keyword is deprecated and will be supported only for compatibility
reasons to CQL 1.0 (because <span style='white-space:nowrap;'>CQL-S</span> provides
<span style='white-space:nowrap;'><a href="CQL-Match-List.html#match:eithercolor">:eithercolor</span></span> : <span style='white-space:nowrap;'>match</span></a> as an extension of <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:flipcolor">:flipcolor</span></a>).
</p>

<p>
This keyword takes one argument, the same as the argument to
<span style='white-space:nowrap;'><a href="CQL-Match-List.html#match:result">:result (match)</span></span> : <span style='white-space:nowrap;'>match</span></a> in a match list. Inside a position
list it will be affected by <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:flipcolor">:flipcolor</span></a>.
</p>

<p>
Example:
</p>

<div class='box'><pre><code><!--
-->(match (
  (position
    <span style='white-space:nowrap;'><span class='keyword'>:result</span></span> 1-0
    <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:whiteelo">:whiteelo</span></a> 0 2300
    <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:blackelo">:blackelo</span></a> &gt;=2600
    <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:flipcolor">:flipcolor</span></a>))<!--
--></code></pre></div>

<p>
Searches for games in which a 2300 player or below defeated a 2600 player
or above.
</p>

<h3 id="match:startposition">:startposition&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
This will take a comma-separated list of start positions. A start
position is either a position number, or a FICS variant identifier.
For a detailed description see <span style='white-space:nowrap;'><a href="CQL-Match-List.html#match:startposition">:startposition</span></span> : <span style='white-space:nowrap;'>match</span></a>.
</p>

<p>
See also: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:ischess960">:ischess960</span></a>, <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:isshufflechess">:isshufflechess</span></a>.
</p>

<h3 id="position:variant">:variant</h3>

<p>
For a description see identically named keyword <span style='white-space:nowrap;'><a href="CQL-Match-List.html#match:variant">:variant (match)</span></span> : <span style='white-space:nowrap;'>match</span></a>
in match list. This keyword is added for the possibility to distinguish between
different <a href="Chess-Variants.html">chess variants</a> in each position list.
</p>

<h3 id="position:whiteelo">:whiteelo</h3>

<p>
This keyword takes a <a href="CQL-Range-Specifiers.html">range specifier</a>;
the ELO of the white player must lie within its range. One special case:
</p>

<div class='verb'><code>
<span style='white-space:nowrap;'><span class='keyword'>:whiteelo</span></span> 0
</code></div>

<p>
In this case all games will match whose white player does not have an ELO rating.
</p>

<p>
See also: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:blackelo">:blackelo</span></a>, <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:blackrating">:blackrating</span></a>,
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:whiterating">:whiterating</span></a>.
</p>

<!-- ############################################################################## -->
<h2 id="relation">Relation between positions</h2>
<!-- ############################################################################## -->

<table style="white-space:nowrap">
  <tr><td>&#x2022;</td><td><a href="#position:relation">:relation</a></td></tr>
</table>

<h3 id="position:relation">:relation</h3>

<p>
Takes one argument, a relation specification. is used to search for games with
pairs of positions P1 and P2 that satisfy certain properties. See
<a href="CQL-Relation-List.html">relation list</a> for a desription of
the relation specification keywords.
</p>

<!-- ############################################################################## -->
<h2 id="matching">Matching count keywords</h2>
<!-- ############################################################################## -->

<p>
Two keywords pertain to the number of positions which a position list matches.
These each take a <a href="CQL-Range-Specifiers.html">range specifier</a>
as parameter. They can only be used in a position list at the top level of a
match list.
</p>

<table style="white-space:nowrap">
  <tr><td>&#x2022;</td><td><a href="#position:checkcount">:checkcount</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:matchcount">:matchcount</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:pretransformmatchcount">:pretransformmatchcount</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:pretransformrepetitioncount">:pretransformrepetitioncount</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:repetitioncount">:repetitioncount</a></td></tr>
</table>

<h3 id="position:checkcount">:checkcount&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
If the parameter is a single number (not less that zero), it is
matching all positions where last move is giving n-th check to other side.
</p>

<p>
If the parameter has the form <span style='white-space:nowrap;'><code>+&lt;n<sub>1</sub>&gt;+&lt;n<sub>2</sub>&gt;</code></span>,
where <span style='white-space:nowrap;'><code>&lt;n<sub>i</sub>&gt;</code></span> is a number not less than zero,
it is matching first position where white has given n<sub>1</sub> times check
to black, and black has given n<sub>2</sub> times check to white.
</p>

<p><img src='../images/note.png' alt='note' /> 
This query is working only in chess variant Three-check Chess,
in other chess variants it fails always (except all values in given parameter
are zero).
</p>

<p>
Examples:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:checkcount</span></span> 2)
</code></div>

<p>
Match as soon as any side has given second check.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:checkcount</span></span> +0+3)
</code></div>

<p>
Match if black has given third check to white king. This must be a final
position.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:not">:not</span></a> <span style='white-space:nowrap;'><span class='keyword'>:checkcount</span></span> +0+0)
</code></div>

<p>
This is in fact a useful query. Assume that a game is starting with the
following position (described with
<a href="FEN.html">Forsyth-Edwards Notation</a>):
</p>

<ul style='list-style-type: none'><li><code>
rnb1k1nr/pppp1ppp/8/4p3/3PP2q/2N5/PP3PPP/R1BQKBNR w KQkq - 1 5 +0+2
</code></li></ul>

<p>
This game would match (note keyword <span style='white-space:nowrap;'>:not</span>), because black has already
given second check to white king. With other words, this query is searching for
games starting with an advanced position, where one side has already given a
check.
</p>

<h3 id="position:matchcount">:matchcount</h3>

<p>
Will match if and only if the number of times this position list matches a
position in the current game lies within the
<a href="CQL-Range-Specifiers.html">range specifier</a>.
</p>

<p>
Example:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:moveto">:moveto</span></a> [<span class='piece'>&#x2655;</span><span class='piece'>&#x265b;</span>] <span style='white-space:nowrap;'><span class='keyword'>:matchcount</span></span> &gt;=4)
</code></div>

<p>
Will match any game in which at least four queen captures have occurred.
</p>

<h3 id="position:pretransformmatchcount">:pretransformmatchcount</h3>

<p>
Has the same syntax as <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:matchcount">:matchcount</span></a>. For a description
of this keyword we will suppose the following general form of a position
list:
</p>

<div class='box'><pre><code><!--
-->(position
  T<sub>1</sub> T<sub>2</sub> ... T<sub>k</sub>
  X<sub>1</sub> X<sub>2</sub> ... X<sub>n</sub>
  <span style='white-space:nowrap;'><span class='keyword'>:pretransformmatchcount</span></span> n<sub>1</sub> n<sub>2</sub>)<!--
--></code></pre></div>

<p>
All <span style='white-space:nowrap;'><code>T<sub>i</sub></code></span> are denoting the transformation keywords,
and all other elements (but no transformation keywords) are denoted with
<span style='white-space:nowrap;'><code>X<sub>i</sub></code></span>. <span style='white-space:nowrap;'><code>n<sub>1</sub></code></span>
<span style='white-space:nowrap;'><code>n<sub>2</sub></code></span> is the range specifier. Now we suppose that
<span style='white-space:nowrap;'><code>Y<sub>i,j</sub></code></span> is denoting an element formed by one
transformation step j applied to <span style='white-space:nowrap;'><code>X<sub>i</sub></code></span> (possibly
identical to <span style='white-space:nowrap;'><code>X<sub>i</sub></code></span> because it is
transformation-invariant). <span style='white-space:nowrap;'><code>m</code></span> denotes the total count of all
transformation steps. Now we will form a new position list:
</p>

<div class='box'><pre><code><!--
-->(position
  <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:or">:or</span></a> (
    (position Y<sub>1,1</sub> Y<sub>2,1</sub> ... Y<sub>n,1</sub> <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:matchcount">:matchcount</span></a> n<sub>1</sub> n<sub>2</sub>)
    (position Y<sub>1,2</sub> Y<sub>2,2</sub> ... Y<sub>n,2</sub> <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:matchcount">:matchcount</span></a> n<sub>1</sub> n<sub>2</sub>)
    ...
    (position Y<sub>1,m</sub> Y<sub>2,m</sub> ... Y<sub>n,m</sub> <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:matchcount">:matchcount</span></a> n<sub>1</sub> n<sub>2</sub>)))<!--
--></code></pre></div>

<p>
The position list containing <span style='white-space:nowrap;'>:pretransformmatchcount</span> is matching
exactly those positions matched from our newly formed position list.
With other words: the match count will be performed for each individual
transformation step.
</p>

<p>
Example:
</p>

<div class='box'><pre><code><!--
-->(position
  <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:moveto">:moveto</span></a> [Aa]d4
  <span style='white-space:nowrap;'><span class='keyword'>:pretransformmatchcount</span></span> &gt;=12
  <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:shift">:shift</span></a>))<!--
--></code></pre></div>

<p>
This would match any game in which at least 12 captures occur on the same
square. Were the <span style='white-space:nowrap;'>:pretransformmatchcount</span> replaced by
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:matchcount">:matchcount</span></a>, the position list would match games in which
at least 12 captures occurred anywhere on board.
</p>

<h3 id="position:pretransformrepetitioncount">:pretransformrepetitioncount&ensp;<img src="../images/ft-scidb-tiny.png" alt="" />&emsp;<span class='normal'>(PrÃ¤-Transformation-WiederholungszÃ¤hler)</span></h3>

<p>
Dieses SchlÃ¼sselwort hat die gleiche Syntax wie <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:repetitioncount">:repetitioncount</span></a>,
und ist so zu verstehen wie das Ã¤hnliche SchlÃ¼sselwort
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:pretransformmatchcount">:pretransformmatchcount</span></a>, nur daÃ <span style='white-space:nowrap;'>:repetitioncount</span>
aufeinanderfolgende Positionsmerkmale zÃ¤hlt.
</p>

<p>
Beispiel:
</p>

<div class='box'><pre><code><!--
-->(position
  <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:moveto">:moveto</span></a> <span class='cql' title='Any piece at all'>&#x25d1;</span>d4
  <span style='white-space:nowrap;'><span class='keyword'>:pretransformrepetitioncount</span></span> &gt;=6
  <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:shift">:shift</span></a>)<!--
--></code></pre></div>

<p>
Dies wÃ¼rde jede Partie finden in der mindestens sechs Figuren aufeinanderfolgend
auf dem gleichen Feld geschlagen wurden.
</p>

<h3 id="position:repetitioncount">:repetitioncount&ensp;<img src="../images/ft-scidb-tiny.png" alt="" />&emsp;<span class='normal'>(WiederholungszÃ¤hler)</span></h3>

<p>
Filtert eine Position, wenn sich die Positionsmerkmale aufeinanderfolgend wiederholen,
wobei die Anzahl der Wiederholungen durch eine
<a href="CQL-Range-Specifiers.html">Bereichsangabe</a> spezifiziert wird.
</p>

<p>
Beispiele:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:moveto">:moveto</span></a> <span class='cql' title='Any piece at all'>&#x25d1;</span> <span style='white-space:nowrap;'><span class='keyword'>:repetitioncount</span></span> &gt;=10)
</code></div>

<p>
Filtert jede Position, in der aufeinanderfolgend mindestens zehn Figuren geschlagen werden.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:moveto">:moveto</span></a> <span class='cql' title='Any piece at all'>&#x25d1;</span> <span style='white-space:nowrap;'><span class='keyword'>:repetitioncount</span></span> 0)
</code></div>

<p>
Filtert jede Partie, in der niemals eine Figur geschlagen wird. Jedoch ist es gÃ¼nstiger,
dies so zu formulieren:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:moveto">:moveto</span></a> <span class='cql' title='Any piece at all'>&#x25d1;</span> <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:matchcount">:matchcount</span></a> 0)
</code></div>

<!-- ############################################################################## -->
<h2 id="evaluation">Analyzing keywords</h2>
<!-- ############################################################################## -->

<p>
The following keywords are analyzing positions. <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:evaluation">:evaluation</span></a> and
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:moveevaluation">:moveevaluation</span></a> should be used with care, these are very slow
operations. In some cases the keywords <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:exchangeevaluation">:exchangeevaluation</span></a> and
<span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:maxswapevaluation">:maxswapevaluation</span></a> might be an alternative, these functions are
quite faster, although fairly time consuming.
</p>

<table style="white-space:nowrap">
  <tr><td>&#x2022;</td><td><a href="#position:endgameevaluation">:endgameevaluation</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:endgameevaluation_">:endgameevaluation*</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:evaluation">:evaluation</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:exchangeevaluation">:exchangeevaluation</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:maxswapevaluation">:maxswapevaluation</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:moveevaluation">:moveevaluation</a></td></tr>
</table>

<h3 id="position:endgameevaluation">:endgameevaluation&ensp;<img src="../images/ft-scidb-tiny.png" alt="" />&emsp;<span class='normal'>(Endspielbewertung)</span></h3>

<p>
Dieses SchlÃ¼sselwort bewertet die aktuelle Endspielposition mit Hilfe von
Endspieltabellen (Tablebases). Dieses SchlÃ¼sselwort kann nur dann erfÃ¼llt
werden, wenn die entsprechenden Endspieltabellen lokal vorliegen (es erfolgt
keine Online-Abfrage).
</p>

<p>
Als erstes Argument wird spezifiziert, welches Ergebnis laut Endspieltabellen
bei bestem Spiel erzielt wird:
</p>

<div class='box'>
  <table>
    <tr>
      <td class="l"><span style='white-space:nowrap;'><code>remis</code></span></td><td class="r">Das Endspiel ist remis.</td>
    </tr>
    <tr>
      <td class="l"><span style='white-space:nowrap;'><code>mate</code></span></td><td class="r">Die Seite am Zug kann gewinnen.</td>
    </tr>
    <tr>
      <td class="l"><span style='white-space:nowrap;'><code>*mate</code></span></td><td class="r">Einer der Parteien kann gewinnen.</td>
    </tr>
    <tr>
      <td class="l"><span style='white-space:nowrap;'><code>+mate</code></span></td><td class="r">WeiÃ kann gewinnen.</td>
    </tr>
    <tr>
      <td class="l"><span style='white-space:nowrap;'><code>-mate</code></span></td><td class="r">Schwarz kann gewinnen.</td>
    </tr>
  </table>
</div>

<p>
Das optionale zweite Argument gibt an, wieviele HalbzÃ¼ge minimal und maximal
bei beidseitig bestem Spiel erforderlich sind, um Matt zu setzen.
</p>

<p>
Beispiele:
</p>

<div class='box'><pre><code><!--
-->(position
  <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> <span class='cql' title='Any piece at all'>&#x25d1;</span> 6
  <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> <span class='piece'>&#x2659;</span> 2
  <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> <span class='piece'>&#x265f;</span> 2
  <span style='white-space:nowrap;'><span class='keyword'>:endgameevaluation</span></span> *mate)<!--
--></code></pre></div>

<p>
Filtert alle Positionen mit einem Endspiel <span style='white-space:nowrap;'><code><span class='piece'>&#x2654;</span>+<span class='piece'>&#x2659;</span>+<span class='piece'>&#x2659;</span></code></span> gegen
<span style='white-space:nowrap;'><code><span class='piece'>&#x2654;</span>+<span class='piece'>&#x2659;</span>+<span class='piece'>&#x2659;</span></code></span>, in dem einer der Parteien laut Endspieltabelle gewinnen kann.
</p>

<div class='box'><pre><code><!--
-->(position
  <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> <span class='cql' title='Any piece at all'>&#x25d1;</span> 6
  <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> <span class='piece'>&#x2659;</span> 2
  <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:piececount">:piececount</span></a> <span class='piece'>&#x265f;</span> 2
  <span style='white-space:nowrap;'><span class='keyword'>:endgameevaluation</span></span> mate &gt;=40)<!--
--></code></pre></div>

<p>
Filtert alle Positionen mit einem Endspiel <span style='white-space:nowrap;'><code><span class='piece'>&#x2654;</span>+<span class='piece'>&#x2659;</span>+<span class='piece'>&#x2659;</span></code></span> gegen
<span style='white-space:nowrap;'><code><span class='piece'>&#x2654;</span>+<span class='piece'>&#x2659;</span>+<span class='piece'>&#x2659;</span></code></span>, in dem die Seite am Zug laut Endspieltabelle gewinnen
kann, aber dafÃ¼r bei beidseitig bestem Spiel mindestens 40 HalbzÃ¼ge zum Matt
benÃ¶tigt.
</p>

<h3 id="position:endgameevaluation_">:endgameevaluation*&ensp;<img src="../images/ft-scidb-tiny.png" alt="" />&emsp;<span class='normal'>(Endspielbewertung)</span></h3>

<p>
Diese Version von <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:endgameevaluation">:endgameevaluation</span></a> untersucht nur die Positionen,
in denen die spezifizierte Figurenkonstellation zum ersten Mal in der Partie erfÃ¼llt wird.
Somit ist diese Version unter UmstÃ¤nden erheblich schneller in der Suche.
</p>

<h3 id="position:evaluation">:evaluation&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<div class='annotation'><img src='../images/annotation.png' style='float:left; margin:0 1em 0 0' alt='annotation' />
This is a very slow operation and should be used with restrictions.
</div>

<p>
This keyword is evaluating the current position with the help of an
external chess engine. The first two parameter are specifying the
computation mode:
</p>

<ul style='list-style-type: none'><li>
  <table>
    <!-- UCI:  "go depth <x>" -->
    <!-- WB:   "st <x>"       -->
    <tr>
      <td class="l"><span style='white-space:nowrap;'><code>depth &lt;d&gt;</code></span></td>
      <td class="r">search &lt;d&gt; plies only</td>
    </tr>

    <!-- UCI:  "go movetime <x>" -->
    <!-- WB:   "time <x/10>"     -->
    <tr>
      <td class="l"><span style='white-space:nowrap;'><code>movetime &lt;ms&gt;</code></span></td>
      <td class="r">search exactly &lt;ms&gt; milli-seconds per move</td>
    </tr>
  </table>
</li></ul>

<p>
Now you can either specify a search for mate, or a search for position
evaluation.
</p>

<p>
A search for mate expects one more parameter: namely the word <i>mate</i>.
A query is successful if a mate has been found.
</p>

<p>
The search for position evaluation is expecting three additional parameters.
The first one denotes the lower bound, the second one denotes the upper bound,
both scores are in pawn units. The query succeeds if the evaluation of the
position is within the specified bounds (inclusive the ranges). If the
lower-bound value is specified with <i>unlimited</i>, it means negative
unlimited. If the upper-bound value is specified with <i>unlimited</i>, it
means positive unlimited. The third parameter is either <i>sidetomove</i> or
<i>absolute</i>. <i>sidetomove</i> means that the evaluation value depends on
side to move, and <i>absolute</i> means that the evaluation value is
independent from side to move.
</p>

<p><img src='../images/note.png' alt='note' /> 
Please note that in mode <i>movetime</i> the specification of the milli-seconds
will be rounded up to centi-seconds if the engine is restricted to
<span style='white-space:nowrap;'>WinBoard</span>/<span style='white-space:nowrap;'>XBoard</span> protocol. If the UCI
protocol is available then the exact number of milli-seconds will be used.
</p>

<p>
Examples:
</p>

<div class='verb'><code>
<span style='white-space:nowrap;'><span class='keyword'>:evaluation</span></span> depth 4 &gt;=2.5 sidetomove
</code></div>

<p>
Side to move has (probably) a winning position, because he is
at least 2.5 pawn units ahead.
</p>

<div class='verb'><code>
<span style='white-space:nowrap;'><span class='keyword'>:evaluation</span></span> depth 4 &lt;=-2.5 sidetomove
</code></div>

<p>
Side to move has (probably) a losing position, because he is
at least 2.5 pawn units behind.
</p>

<div class='verb'><code>
<span style='white-space:nowrap;'><span class='keyword'>:evaluation</span></span> movetime 3000 &lt;=-3.0 absolute
</code></div>

<p>
Black is (probably) losing, because he is at least 3 pawn units behind.
</p>

<div class='verb'><code>
<span style='white-space:nowrap;'><span class='keyword'>:evaluation</span></span> depth 6 mate
</code></div>

<p>
Either side can be mated in maximal 3 moves (6 plies).
</p>

<h3 id="position:exchangeevaluation">:exchangeevaluation&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
This keyword is analyzing capture moves to see whether or not they appear
to be profitable.
</p>

<p>
The keyword will match the current move if this value is in the specified range,
a lower and an upper value in pawn units. Only capture moves will be evaluated.
If lower range is specified with <i>unlimited</i>, it means negative unlimited.
If the lower range is specified with <i>unlimited</i>, it means positive unlimited.
The evaluation function is taking into account that pieces may be pinned or
defended by other pieces. The value of the function does not depend on which
side is to move.
</p>

<p>
Concerning the piece values see <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:power">:power</span></a>.
</p>

<p>
Note that this function is not evaluating the position, instead it is
estimating the exchange values.
</p>

<p>
Example:
</p>

<div class='verb'><code>
<span style='white-space:nowrap;'><span class='keyword'>:exchangeevaluation</span></span> &lt;=-3
</code></div>

<p>
This capture move is (probably) a blunder.
</p>

<h3 id="position:maxswapevaluation">:maxswapevaluation&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
This keyword allows to estimate exchange values of possible moves. It takes
as arguments two piece designators followed by a
<a href="CQL-Range-Specifiers.html">range specifier</a>. The first argument
specifies moving pieces, the second one specifies target squares. For each
possible moves we compute an integer value that is a material benefit of the
move (in pawns, like in case of the <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:power">:power</span></a> keyword)
according to possible piece exchanges on the target square after the move.
After that the maximum of all computed values will be selected.
</p>

<p>
The keyword match the position if this value lies in the specified range
(a lower and an upper value). If lower range is specified with <i>unlimited</i>,
it means negative unlimited. If the lower range is specified with <i>unlimited</i>,
it means positive unlimited. The evaluation function is taking into account that
pieces may be pinned or defended by other pieces. The value of the function does
not depend on which side is to move.
</p>

<p>
Concerning the piece values see <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:power">:power</span></a>.
</p>

<p>
Note that this function is not evaluating the position, instead it is
estimating the exchange values.
</p>

<p><img src='../images/note.png' alt='note' /> 
This keyword is alike the keyword <span style='white-space:nowrap;'>:maxswapvalue</span> from Chess
Assistant 9 (&#x21d2;
<a href="http://hornid.com/chess/docs/CQL-3GX.pdf" target="blank_">The CQL 3.GX Extension&nbsp;<span class="awesome">&#xf08e;</span></a>),
but quite different implemented.
</p>

<p>
Examples:
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:maxswapevaluation</span></span> <span class='cql' title='Any white piece'>&#x25cb;</span> <span class='cql' title='Any black piece'>&#x25cf;</span> &gt;=1)
</code></div>

<p>
This query selects positions in which white threatens with
winning some material.
</p>

<div class='verb'><code>
(position <span style='white-space:nowrap;'><span class='keyword'>:maxswapevaluation</span></span> <span class='piece'>&#x2655;</span>?1-7 ??8 &gt;=0)
</code></div>

<p>
This query selects positions in which a white queen can invade rank 8
without a material loss.
</p>

<h3 id="position:moveevaluation">:moveevaluation&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<div class='annotation'><img src='../images/annotation.png' style='float:left; margin:0 1em 0 0' alt='annotation' />
This is a very slow operation and should be used with restrictions.
</div>

<p>
This keyword is matching the difference between the evaluation of the current
position and the evaluation of the preceding position. The evaluation will be
done with the help of an external chess engine. It takes seven parameters.
The first and second parameter are piece designators. The former is specifies
moving pieces, the second one specifies target squares. The third and fourth
are specifiying the computation mode:
</p>

<ul style='list-style-type: none'><li>
  <table>
    <!-- UCI:  "go depth <x>" -->
    <!-- WB:   "st <x>"       -->
    <tr>
      <td class="l"><span style='white-space:nowrap;'><code>depth &lt;d&gt;</code></span></td>
      <td class="r">search &lt;d&gt; plies only</td>
    </tr>

    <!-- UCI:  "go movetime <x>" -->
    <!-- WB:   "time <x/10>"     -->
    <tr>
      <td class="l"><span style='white-space:nowrap;'><code>movetime &lt;ms&gt;</code></span></td>
      <td class="r">search exactly &lt;ms&gt; milli-seconds per move</td>
    </tr>
  </table>
</li></ul>

<p>
The fifth parameter denotes the lower bound score, the sixth parameter denotes
the upper bound score, both scores are in pawns units. If the lower-bound value
is specified with <i>unlimited</i>, it means negative unlimited. If the upper-bound
value is specified with <i>unlimited</i>, it means positive unlimited. The query
succeeds if the scoring of preceding move is within the given bounds (inclusive the
ranges). The score of preceding move is the difference between the score of the
current position minus the score of the preceding position. In case of mating
positions the difference will be always greater than 10,000.
</p>

<p>
The seventh parameter is either <i>sidetomove</i> or <i>absolute</i>.
<i>sidetomove</i> means that the evaluation value depends on side to move, and
<i>absolute</i> means that the evaluation value is independent from side to move.
</p>

<p><img src='../images/note.png' alt='note' /> 
Please note that in mode <i>movetime</i> the specification of the milli-seconds
will be rounded up to centi-seconds if the engine is restricted to
<span style='white-space:nowrap;'>WinBoard</span>/<span style='white-space:nowrap;'>XBoard</span> protocol. If the UCI
protocol is available then the exact number of milli-seconds will be used.
</p>

<p>
Examples:
</p>

<div class='verb'><code>
<span style='white-space:nowrap;'><span class='keyword'>:moveevaluation</span></span> <span class='cql' title='Any piece at all'>&#x25d1;</span> ? depth 4 &gt;=3.0 sidetomove
</code></div>

<p>
Match first position were the score difference is at least 3.0 pawn units.
This means that last move was (probably) a blunder.
</p>

<div class='verb'><code>
<span style='white-space:nowrap;'><span class='keyword'>:moveevaluation</span></span> <span class='cql' title='Any white piece'>&#x25cb;</span> <span class='cql' title='Any black piece'>&#x25cf;</span> depth 4 &lt;=-3.0 absolute
</code></div>

<p>
Match first position were the evaluation difference is at least 3.0 pawn units
better for black. This means that last white move was (probably) a blunder.
Only capture moves were evaluated.
</p>

<div class='box'><pre><code><!--
-->(match
  (position <span style='white-space:nowrap;'><span class='keyword'>:moveevaluation</span></span> [<span class='piece'>&#x2659;</span><span class='piece'>&#x265f;</span>] ?[?1,?8]
             &lt;=0.0 movetime 5000 absolute)
  (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:promotion">:promotion</span></a> <span class='cql' title='Any piece at all'>&#x25d1;</span> <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:cut">:cut</span></a>)))
  (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:preceding">:preceding</span></a>)<!--
--></code></pre></div>

<p>
Search for positions where side to move is doing first promotion in game, but
without gaining a better score. We have ensured that only promoting moves will
be evaluated.
</p>

<!-- ############################################################################## -->
<h2 id="accumulator">Accumulator keywords</h2>
<!-- ############################################################################## -->

<p>
There are mainly two accumulator keywords, <span style='white-space:nowrap;'>:accumulate</span> and
<span style='white-space:nowrap;'>:sumrange</span>. These are used to accumulate and to test the number of
transforms of the enclosing position list that match the current position. Each
time a transform of a position list matches a position, the accumulator
associated with that position is incremented. Any position with a sum range can
then test if the accumulator is within a certain range.
</p>

<table style="white-space:nowrap">
  <tr><td>&#x2022;</td><td><a href="#position:accumulate">:accumulate</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:accumulate_">:accumulate*</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:sumrange">:sumrange</a></td></tr>
</table>

<h3 id="position:accumulate">:accumulate</h3>

<p>
This takes one parameter, the name of an accumulator. Each time the application
of some element of the transform set of the position list matches a position,
the accumulator associated with this name is incremented. The accumulator is
cleared when a new position is reached. In consequence <span style='white-space:nowrap;'>:accumulate</span>
should not be used inside of <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:not">:not</span></a>, or
the <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:sequence">:sequence</span></a> and <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:gappedsequence">:gappedsequence</span></a>
keywords). Note that <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:flipcolor">:flipcolor</span></a> likely has unexpected
results when used with <span style='white-space:nowrap;'>:accumulate</span>, because the accumulator is not
cleared between color flips.
</p>

<p>
For examples see:
<a href="CQL-Examples.html#accumulator">Using accumulators to count passed pawns</a>.
</p>

<p>
See also: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:accumulate_">:accumulate*</span></a>
</p>

<h3 id="position:accumulate_">:accumulate*&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
To use the accumulation combined with <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:flipcolor">:flipcolor</span></a> CQL-S provides
an extension: in the case variant <span style='white-space:nowrap;'>:accumulate*</span> is used, each color will be
counted separately.
</p>

<p>
For an example see: <a href="CQL-Examples.html#accumulator#passed-pawn"
>Using accumulators to count passed pawns</a>.
</p>

<p>
See also: <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:accumulate">:accumulate</span></a>
</p>


<h3 id="position:sumrange">:sumrange&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
This takes as parameter the name of an accumulator and a
<a href="CQL-Range-Specifiers.html">range specifier</a>. It matches a position
if the value of the given accumulator lies within the range specifier.
If variant <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:accumulate_">:accumulate*</span></a> is used, <span style='white-space:nowrap;'>:sumrange</span> will
distinguish between colors automatically.
</p>

<p>
For examples see:
<a href="CQL-Examples.html#accumulator">Using accumulators to count passed pawns</a>.
</p>

<!-- ############################################################################## -->
<h2 id="tagging">Tagging keywords</h2>
<!-- ############################################################################## -->

<table style="white-space:nowrap">
  <tr><td>&#x2022;</td><td><a href="#position:tagmatch">:tagmatch</a></td></tr>
</table>

<h3 id="position:tagmatch">:tagmatch&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
The <span style='white-space:nowrap;'>:tagmatch</span> keyword takes two parameters, the name of a tag and
a piece designator. It matches only if the piece corresponding to the named tag
matches the given piece designator. For more information, see the section
on <a href="CQL-Tagging.html">tagging</a>.
</p>

<!-- ############################################################################## -->
<h2 id="control">Controlling keywords</h2>
<!-- ############################################################################## -->

<p>
With the help of controlling keywords the search flow or search result
will be affected. Actually none of these keywords is extending the capability
of CQL, each of them can be replaced, but the use of these keywords may
improve the search time considerably, and the expression may have a clearer
form.
</p>

<table style="white-space:nowrap">
  <tr><td>&#x2022;</td><td><a href="#position:cut">:cut</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:exclude">:exclude</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#position:skip">:skip</a></td></tr>
</table>

<h3 id="position:cut">:cut&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
This keyword can be used in two forms: either it is included in a position
match list, or it has a sub-position list as argument. In former case:
stop position search for this game as soon as the match of the containing position
list succeeds. In latter case: stop position search of this game as soon as the
match of the sub-position list succeeds. This keyword is never failing, with
other words: it is not influencing the result of all other matches.
</p>

<p>
The <span style='white-space:nowrap;'>:cut</span> position match has lower precedence than all other
position matches.  This means that a position is matching, if all other
position lists are matching this position, independent from the result of the
<span style='white-space:nowrap;'>:cut</span>. If the <span style='white-space:nowrap;'>:cut</span> position match should have highest
precedende, use keyword <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:preceding">:preceding</span></a>. In this case the search
will stop with a negative result, independent from all other matches.
Consider the following examples:
</p>

<div class='verb'><code>
(match (position &lt;A&gt; <span style='white-space:nowrap;'><span class='keyword'>:cut</span></span> (position &lt;B&gt;)))
</code></div>

<p>
Suppose &lt;A&gt; and &lt;B&gt; is matching a position, either the first time. In
this case the match of this game succeeds.
</p>

<div class='verb'><code>
(match (position &lt;A&gt; <span style='white-space:nowrap;'><span class='keyword'>:cut</span></span> (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:preceding">:preceding</span></a>  &lt;B&gt;)))
</code></div>

<p>
Suppose &lt;A&gt; and &lt;B&gt; is matching a position, either the first time. In
this case the match of this game fails.
</p>

<p>
Examples:
</p>

<div class='box'><pre><code><!--
-->(match
  (position
    <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:mate">:mate</span></a>
    <span style='white-space:nowrap;'><span class='keyword'>:cut</span></span> (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:check">:check</span></a>)))<!--
--></code></pre></div>

<p>
Search for games ending with mate, and neither side has ever given
a check before. Actually keyword <span style='white-space:nowrap;'>:cut</span> is not required for this
search criterion, see next example:
</p>

<div class='box'><pre><code><!--
-->(match
  (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:mate">:mate</span></a>)
  (position <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:check">:check</span></a> <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:matchcount">:matchcount</span></a> 1))<!--
--></code></pre></div>

<p>
But this version has to search the whole game, and the former version with
<span style='white-space:nowrap;'>:cut</span> fails as soon as first check occurs. In complex searches the
use of keyword <span style='white-space:nowrap;'>:cut</span> may be much faster than the use of
<span style='white-space:nowrap;'>:matchcount</span>.
</p>

<h3 id="position:exclude">:exclude&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
This keyword can be used in two forms: either it is included in a position
match list, or it has a sub-position list as argument. In former case:
exclude this game if the match of the containing position list succeeds.
In latter case exclude this game if the match of the sub-position list
succeeds. This keyword is not influencing the result of the position
match (see example).
</p>

<p>
This keyword will exclude games even if one of the position matches will
succeed before the <span style='white-space:nowrap;'>:exclude</span> expression is succeeding. In short:
this keyword is excluding games completely under certain conditions.
</p>

<p>
Example:
</p>

<div class='box'><pre><code><!--
-->(match
  (position
    &lt;A&gt;
    <span style='white-space:nowrap;'><span class='keyword'>:exclude</span></span> (position &lt;B&gt;)))<!--
--></code></pre></div>

<p>
Search for games containg a position which is matching expression
<span style='white-space:nowrap;'><code>&lt;A&gt;</code></span>, but not if expression <span style='white-space:nowrap;'><code>&lt;B&gt;</code></span> is
matching any position in this game. Actually this match can be written
without the use of keyword <span style='white-space:nowrap;'>:exclude</span>, in the following way:
</p>

<div class='box'><pre><code><!--
-->(match
  (position
    <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:and">:and</span></a> (
      (position &lt;A&gt;)
      (position &lt;B&gt; <span style='white-space:nowrap;'><a href="CQL-Position-List.html#position:matchcount">:matchcount</span></a> 0))))<!--
--></code></pre></div>

<p>
But the use of keyword <span style='white-space:nowrap;'>:exclude</span> is simpler and clearer.
</p>

<h3 id="position:skip">:skip&ensp;<img src="../images/ft-scidb-tiny.png" alt="" /></h3>

<p>
With the help of this keyword a matching position can be skipped. This could be
expressed without the use of this keyword, but the formulation of the position
list with the help of this keyword is sometimes less complicated, and this results
often in a faster search.
</p>

<!-- ############################################################################## -->
<h2 id="meaningless">Meaningless keywords</h2>
<!-- ############################################################################## -->

<table style="white-space:nowrap">
  <tr><td>&#x2022;</td><td><a href="#match:markall">:markall</a></td></tr>
  <tr><td>&#x2022;</td><td><a href="#match:noannotate">:noannotate</a></td></tr>
</table>

<h3 id="position:markall">:markall</h3>

<p>
This keyword is supported to be compatible with CQL standard, and does
not have any meaning in CQL-S.
</p>

<h3 id="position:noannotate">:noannotate</h3>

<p>
This keyword is supported to be compatible with CQL standard, and does
not have any meaning in CQL-S.
</p>

</body>
</html>
